{"version":3,"sources":["redux/redux-sauce/auth.js","redux/api/endpoints.js","redux/api/authApi.js","redux/sagas/authSagas.js","redux/sagas/index.js","redux/store/index.js","components/CommonForms.js","containers/Main.js","containers/HeaderContainer.js","redux/api/utils.js","components/utils.js","components/Shifts.js","containers/manager/Shifts.js","pages/stockPage/Stock.js","redux/api/stockPageApi.js","components/ShiftCreateComponent.js","containers/manager/CreateShift.js","components/SaleCommon.js","containers/manager/SaleCreateCommon.js","containers/manager/SaleList.js","components/DailyRep.js","containers/manager/DailyRep.js","components/Expenses.js","containers/manager/Expenses.js","containers/manager/RamshikPayments.js","index.js"],"names":["createActions","loginRequest","loginSuccess","loginFailure","signupRequest","signupSuccess","signupFailure","logoutRequest","logoutSuccess","logoutFailure","checkTokenRequest","checkTokenSuccess","checkTokenFail","resetAuthErrors","restorePasswordRequest","restorePasswordSuccess","restorePasswordFailure","toggleModal","checkAuthRequest","checkAuthSuccess","checkAuthFail","setShopToSee","Types","Creators","AuthTypes","INITIAL_STATE","Immutable","fetching","user","error","isLoggedIn","isLoggingIn","shopToSee","AuthSelectors","getUser","state","shop","merge","data","action","signUpRequest","signUpSuccess","signUpFailure","isAuthModalOpen","payload","isLogginIn","reducer","createReducer","SET_SHOP_TO_SEE","LOGIN_REQUEST","LOGIN_SUCCESS","LOGIN_FAILURE","SIGNUP_REQUEST","SIGNUP_SUCCESS","SIGNUP_FAILURE","CHECK_TOKEN_REQUEST","CHECK_TOKEN_FAIL","CHECK_TOKEN_SUCCESS","LOGOUT_REQUEST","LOGOUT_SUCCESS","LOGOUT_FAILURE","TOGGLE_MODAL","RESET_AUTH_ERRORS","CHECK_AUTH_SUCCESS","apiUrl","JWT_AUTH","JWT_CHECK_TOKEN","STOCK","SHIFTS","SALES","RESAWS","DAILY_REP","SALE_CALC_DATA","INCOME_TIMBERS","QUOTAS","RAMSHIK_SHIFT_LIST","RAMSHIK_PAYOUTS","EMPLOYEE_PAYOUT_INIT_DATA","EMPLOYEE_PAYOUT","EMPLOYEE_CREATE","manager_ramshiki_delete","id","MANAGER_SHIFT_LIST","MANAGER_STOCK","MANAGER_STOCK_SET_LUMBER_PRICE","MANAGER_SALE_LIST","MANAGER_RAWSTOCK_INCOME_INIT_DATA","MANAGER_RAWSTOCK_INCOME_CREATE","manager_rawstock_income_delete","MANAGER_SHIFT_CREATE_DATA","MANAGER_SHIFT_CREATE","manager_shift_delete","MANAGER_SALE_INIT_DATA","MANAGER_SALE_CREATE","manager_delete_sale","MANAGER_CASH_RECORDS_LIST","MANAGER_CASH_RECORDS_CREATE","manager_delete_expense","MANAGER_RESAW_CREATE","manager_delete_resaw","CAPO_BOSS_PAYOUT_MANAGER_CREATE","boss_delete_manager_payout","logIn","username","password","axios","post","endpoints","then","response","status","Error","token","catch","err","Object","keys","localStorage","setItem","checkToken","logOut","removeItem","signUp","email","phone","SIGNUP","checkAuth","getItem","group","indexOf","message","api","put","AuthActions","call","root","authApi","AuthApi","all","takeEvery","reducers","combineReducers","auth","require","form","formReducer","renderTextField","label","placeholder","input","multiline","meta","touched","invalid","labelClass","custom","TextField","fullWidth","helperText","InputLabelProps","className","LoginForm","props","parentSubmit","pristine","submitting","reset","handleSubmit","eventFetching","eventError","onSubmit","Field","component","name","margin","type","disabled","DateFilter","startDate","endDate","setData","showResults","value","onChange","shrink","onClick","DayFilter","date","MenuItem","history","useHistory","push","to","style","title","ShopMenu","can_see_shop_stock","reduxForm","validate","values","errors","forEach","field","Main","login","this","CircularProgress","Component","connect","routing","loginForm","dispatch","logout","HeaderComp","histoty","lineHeight","nickname","Header","modalOpen","parseErrorData","errorObj","statusText","JSON","stringify","property","createUrlParamsFromFilters","filters","params","URLSearchParams","key","Array","append","map","lodashToggle","array","item","_","xor","getObjectbyId","list","obj","element","toggleArrayDictById","arr","alreadyIn","index","i","length","splice","replaceItemInDictArrayById","itemInList","slice","getToday","today","Date","dd","String","getDate","padStart","mm","getMonth","yyyy","getFullYear","jsDateTimeToStrDate","jsDate","ShiftLumberTr","record","wood_species","lumber","includes","quantity","volume","rate","total_cash","ShiftComponent","shift","deleteShift","shift_type","employees","back_calc_cash","lumber_records","ShiftList","shiftList","ManagerShiftList","e","setState","target","date_before","date_after","method","url","headers","results","shifts","yesterday","setDate","stockApi","getStock","setLumberPrice","TrRow","showNull","changeMarketCost","show","current_stock_quantity","woodSpeciesClass","current_stock_volume","toFixed","is_manager","shop_rate","is_kladman","stock_total_cash","ManagerStock","lumberId","lumbers","parseInt","totalVolume","totalCash","Switch","checked","FilteredLumberTr","calcType","calcRowAndTotal","tr","volume_total","employee_rate","cash","lumber_type","LumberTableMixed","LumberTable","lumber_record","ShiftToSave","saveData","back","rowClass","employee_cash","note","raw_records","CreatedShift","back_calc_volume","EmployeesBlock","activeEmployees","addEmployee","emp","aEmp","ShiftCreateComponent","calcRowQuantity","qnty","calcRowRate","calcTotalVolume","totalVolumeVar","calcTotalCash","totalCashVar","calcLumber","employee","preSave","eIds","employeesData","cash_per_employee","dataToSave","createdShift","initLumbers","switchCalc","totaCash","res","initData","LumberInputs","calcRowQnty","calcRowVolume","calcRowCash","setRamaPrice","variant","selling_price","selling_total_cash","LumberOptGroup","woodSpecie","lumberType","pineBrus","pineDoska","larchBrus","larchDoska","lumberOptions","LumbersToSale","setLumberID","turnCalc","delLumber","calcRoundRowQnty","calcRoundRowVolume","calcChinaRowQnty","calcChinaRowVolume","stockType","lumberRef","useRef","useState","currentWoodSpecies","setCurrentWoodSpecies","currentLumberType","setCurrentLumberType","filterBtnClass","ref","InputLabel","htmlFor","Select","native","defaultValue","data-id","current","scrollIntoView","aria-label","calc_type","china_volume","SaleCheckList","setAddParams","seller","sellers","client","delivery_fee","FormControl","s","LumbersTable","CreatedSale","sale","seller_fee","SaleCommonToCreate","loader","deliveryFee","sale_cash","SaleCreateCommonContainer","addLumberToSale","lumbersToSale","lumberData","calcTotal","parseFloat","round_volume","setShopPrice","shop_price","setChinaVira","china_vira","bonus_kladman_label","bonus_kladman","createdSale","stock_type","shop_type","pine_brus_lumbers","larch_brus_lumbers","pine_doska_lumbers","larch_doska_lumbers","kladman_id","SalesTable","sales","totals","deleteSale","sale_type","shop_total_cash","kladman_fee","seller_name","total_selling_cash","total_seller_fee","total_kladman_fee","total_delivery_fee","total_add_expenses","SaleList","saleList","bind","SalesList","sales_totals","sellers_fee","total","CashRecordsList","records","record_type","amount","DailyRepContainer","createExpense","expense","KLADMAN_EXPENSE_CREATE","createdExpense","allRecords","expenses","expense_records","total_expenses","expense_records_total","incomes","income_records","total_incomes","income_records_total","records_total","sales_sellers_fee","ExpensesList","deleteExpense","CreateExpense","setCount","setNote","ExpensesContainer","created_at_after","LastOperations","lastOperations","op","created_at","CreateRamshik","newCash","newName","createRamshik","open","setOpen","RamshikPayments","payout","activeEmployee","formData","FormData","last_payouts","deleteRamshik","cash_amount","store","sagaMiddleware","createSagaMiddleware","createStore","composeWithDevTools","applyMiddleware","run","rootSaga","configureStore","ReactDOM","render","maxSnack","exact","path","ManagerRamshikPayments","document","getElementById"],"mappings":"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","file":"static/js/main.72b441ea.chunk.js","sourcesContent":["import { createReducer, createActions } from 'reduxsauce'\r\nimport Immutable from 'seamless-immutable'\r\n\r\n/* ------------- Types and Action Creators ------------- */\r\n\r\nconst { Types, Creators } = createActions({\r\n  loginRequest: ['data'],\r\n  loginSuccess: ['user'],\r\n  loginFailure: ['error'],\r\n\r\n  signupRequest: ['data'],\r\n  signupSuccess: ['user'],\r\n  signupFailure: ['error'],\r\n\r\n  logoutRequest: null,\r\n  logoutSuccess: null,\r\n  logoutFailure: ['error'],\r\n\r\n  checkTokenRequest: ['payload'],\r\n  checkTokenSuccess: ['payload'],\r\n  checkTokenFail: ['error'],\r\n\r\n  resetAuthErrors: null,\r\n\r\n  restorePasswordRequest: ['data'],\r\n  restorePasswordSuccess: null,\r\n  restorePasswordFailure: ['error'],\r\n\r\n  toggleModal: ['isAuthModalOpen'],\r\n  \r\n  checkAuthRequest: ['payload'],\r\n  checkAuthSuccess: ['payload'],\r\n  checkAuthFail: null,\r\n\r\n  setShopToSee: ['shop'],\r\n})\r\n\r\nexport const AuthTypes = Types\r\nexport default Creators\r\n\r\n/* ------------- Initial State ------------- */\r\n\r\nexport const INITIAL_STATE = Immutable({\r\n  fetching: false,\r\n  user: null,\r\n  error: '',\r\n  isLoggedIn: false,\r\n  isLoggingIn: false,\r\n  shopToSee: {},\r\n})\r\n\r\n/* ------------- Selectors ------------- */\r\n\r\nexport const AuthSelectors = {\r\n  getUser: state => state.user\r\n}\r\n\r\n/* ------------- Reducers ------------- */\r\n\r\n// shop to see\r\nexport const setShopToSee = (state, { shop }) => {\r\n  return state.merge({ shopToSee: shop })\r\n}\r\n\r\n// login request\r\nexport const loginRequest = (state, { data }) => {\r\n  return state.merge({ fetching: true, user: null, isLoggingIn: true, isLoggedIn: false, shopToSee: {} })\r\n}\r\n  \r\n\r\n// login success\r\nexport const loginSuccess = (state, { user }) => {\r\n  return state.merge({ fetching: false, error: null, user: user, isLoggedIn: true, isLoggingIn: false })\r\n}\r\n\r\n// login fail\r\nexport const loginFailure = (state, action) => {\r\n  const { error } = action\r\n  return state.merge({ fetching: false, error: error, user: null, isLoggedIn: false, isLoggingIn: false })\r\n}\r\n\r\n// register request\r\nexport const signUpRequest = (state, { data }) =>\r\n  state.merge({ fetching: true, user: {}, isLoggingIn: true, isLoggedIn: false })\r\n\r\n// register success\r\nexport const signUpSuccess = (state, { user }) => {\r\n  return state.merge({ fetching: false, error: null, user: user, isLoggingIn: false, isLoggedIn: true  })\r\n}\r\n\r\n// register fail\r\nexport const signUpFailure = (state, { error }) => {\r\n  return state.merge({ fetching: false, error: error, user: null, isLoggingIn: false, isLoggedIn: false  })\r\n}\r\n\r\n// logout request\r\nexport const logoutRequest = (state) => {\r\n  return state.merge({ fetching: true, isLoggingIn: true })\r\n}\r\n  \r\n\r\n// logout success\r\nexport const logoutSuccess = (state) => {\r\n  return state.merge({ fetching: false, error: null, user: null, isLoggingIn: false, isLoggedIn: false  })\r\n}\r\n\r\n// logout fail\r\nexport const logoutFailure = (state, { error }) => {\r\n  return state.merge({ fetching: false, error: error, isLoggingIn: false })\r\n}\r\n\r\nexport const resetAuthErrors = (state) => {\r\n  return state.merge({ fetching: false, error: null })\r\n}\r\n\r\n// auth modal toggle \r\n\r\nexport const toggleModal = (state, { isAuthModalOpen }) => {\r\n  return state.merge({ isAuthModalOpen, error: null })\r\n}\r\n  \r\nexport const checkTokenRequest = (state, { payload }) => {\r\n  return state.merge({ fetching: true })\r\n}\r\n\r\nexport const checkTokenSuccess = (state, { payload }) => {\r\n  return state.merge({ fetching: false, error: null, user: payload.user, isLoggedIn: true, isLoggingIn: false })\r\n}\r\n\r\nexport const checkTokenFail = (state, { error }) => {\r\n  return state.merge({ fetching: false, error: error, user: null, isLoggedIn: false, isLoggingIn: false })\r\n}\r\n\r\nexport const checkAuthSuccess = (state, { payload }) => {\r\n  return state.merge({ user: payload, isLoggedIn: true, isLogginIn: false })\r\n}\r\n\r\n/* ------------- Hookup Reducers To Types ------------- */\r\n\r\nexport const reducer = createReducer(INITIAL_STATE, {\r\n  [Types.SET_SHOP_TO_SEE]: setShopToSee,\r\n\r\n  [Types.LOGIN_REQUEST]: loginRequest,\r\n  [Types.LOGIN_SUCCESS]: loginSuccess,\r\n  [Types.LOGIN_FAILURE]: loginFailure,\r\n  [Types.SIGNUP_REQUEST]: signUpRequest,\r\n  [Types.SIGNUP_SUCCESS]: signUpSuccess,\r\n  [Types.SIGNUP_FAILURE]: signUpFailure,\r\n  [Types.CHECK_TOKEN_REQUEST]: checkTokenRequest,\r\n  [Types.CHECK_TOKEN_FAIL]: checkTokenFail,\r\n  [Types.CHECK_TOKEN_SUCCESS]: checkTokenSuccess,\r\n  [Types.LOGOUT_REQUEST]: logoutRequest,\r\n  [Types.LOGOUT_SUCCESS]: logoutSuccess,\r\n  [Types.LOGOUT_FAILURE]: logoutFailure,\r\n  [Types.TOGGLE_MODAL]: toggleModal,\r\n  [Types.RESET_AUTH_ERRORS]: resetAuthErrors,\r\n  [Types.CHECK_AUTH_SUCCESS]: checkAuthSuccess\r\n})\r\n","const localUrl = 'http://192.168.0.49:8000'\r\nconst prodUrl = 'http://77.222.54.204'\r\n\r\nexport const url = (process.env.REACT_APP_ENV === 'local' && localUrl) || (process.env.REACT_APP_ENV === 'prod' && prodUrl);\r\nexport const apiUrl = `${url}/api`;\r\n\r\nexport default {\r\n    JWT_AUTH: `${apiUrl}/jwt/api-token-auth/`,\r\n    JWT_CHECK_TOKEN: `${apiUrl}/jwt/api-token-verify/`,\r\n\r\n    //common_api\r\n    STOCK: `${apiUrl}/common/stock/`,\r\n    SHIFTS: `${apiUrl}/common/shifts/`,\r\n    SALES: `${apiUrl}/common/sales/`,\r\n    RESAWS: `${apiUrl}/common/resaw/`,\r\n    DAILY_REP: `${apiUrl}/common/daily_report/`,\r\n    SALE_CALC_DATA: `${apiUrl}/common/sales/calc_data/`,\r\n    INCOME_TIMBERS: `${apiUrl}/common/income_timbers/`,\r\n    QUOTAS: `${apiUrl}/common/quotas/`,\r\n\r\n    // ramshik api\r\n    // RAMSHIK_SHIFT_CREATE_DATA: `${apiUrl}/ramshik/shifts/create/init_data/`,\r\n    // RAMSHIK_SHIFT_CREATE: `${apiUrl}/ramshik/shifts/create/`,\r\n    RAMSHIK_SHIFT_LIST: `${apiUrl}/ramshik/shifts/list/`,\r\n    RAMSHIK_PAYOUTS: `${apiUrl}/ramshik/payouts/`,\r\n\r\n    // manager api\r\n    EMPLOYEE_PAYOUT_INIT_DATA: `${apiUrl}/manager/ramshik_payments/init_data/`,\r\n    EMPLOYEE_PAYOUT: `${apiUrl}/manager/ramshik_payments/ramshik_payout/`,\r\n    EMPLOYEE_CREATE: `${apiUrl}/manager/ramshiki/create/`,\r\n    manager_ramshiki_delete: (id) => `${apiUrl}/manager/ramshiki/${id}/`,\r\n\r\n    MANAGER_SHIFT_LIST: `${apiUrl}/manager/shift_list/`,\r\n\r\n    MANAGER_STOCK: `${apiUrl}/manager/stock/`,\r\n    MANAGER_STOCK_SET_LUMBER_PRICE: `${apiUrl}/manager/stock/set_price/`,\r\n    \r\n    MANAGER_SALE_LIST: `${apiUrl}/manager/sale_list/`,\r\n    \r\n    MANAGER_RAWSTOCK_INCOME_INIT_DATA: `${apiUrl}/manager/rawstock/timber/create_income/init_data/`,\r\n    MANAGER_RAWSTOCK_INCOME_CREATE: `${apiUrl}/manager/rawstock/timber/create_income/`,\r\n    manager_rawstock_income_delete: (id) => `${apiUrl}/manager/rawstock/timber/income_timbers/${id}/`,\r\n\r\n    MANAGER_SHIFT_CREATE_DATA: `${apiUrl}/manager/shifts/create/init_data/`,\r\n    MANAGER_SHIFT_CREATE: `${apiUrl}/manager/shifts/create/`,\r\n    manager_shift_delete: (id) => `${apiUrl}/manager/shifts/${id}/`,\r\n\r\n    MANAGER_SALE_INIT_DATA: `${apiUrl}/manager/sales/create/init_data/`,\r\n    MANAGER_SALE_CREATE: `${apiUrl}/manager/sales/create/`,\r\n    manager_delete_sale: (id) => `${apiUrl}/manager/sales/${id}/`,\r\n\r\n    MANAGER_CASH_RECORDS_LIST: `${apiUrl}/manager/cash_records/list/`,\r\n    MANAGER_CASH_RECORDS_CREATE: `${apiUrl}/manager/cash_records/create_expense/`,\r\n    manager_delete_expense: (id) => `${apiUrl}/manager/cash_records/${id}/`,\r\n\r\n    MANAGER_RESAW_CREATE: `${apiUrl}/manager/resaws/create/`,\r\n    manager_delete_resaw: (id) => `${apiUrl}/manager/resaws/${id}/`,\r\n\r\n    CAPO_BOSS_PAYOUT_MANAGER_CREATE: `${apiUrl}/boss_capo/cash_records/payout_to_manager/`,\r\n    boss_delete_manager_payout: (id) => `${apiUrl}/boss_capo/cash_records/${id}/`,\r\n}","// @flow\r\n\r\nimport axios from 'axios';\r\nimport endpoints from './endpoints';\r\n\r\n\r\nconst create = () => {\r\n  const logIn = (data: { username: string, password: string}): void => {\r\n    const { username, password } = data;\r\n    \r\n     return axios.post(endpoints.JWT_AUTH, { username, password })\r\n      .then(response => {\r\n        if (response.status < 200 || response.status >= 300) {\r\n            throw new Error(response);\r\n        }\r\n        return { token: response.data.token, user: response.data.user };\r\n      })\r\n      .catch(err => {\r\n        throw new Error(err.response.data[Object.keys(err.response.data)[0]][0])\r\n      })\r\n      .then((response) => {\r\n          localStorage.setItem('token', response.token);\r\n          return response.user;\r\n      })\r\n  }\r\n\r\n  const logOut = () => {\r\n    localStorage.removeItem('token');\r\n  }\r\n\r\n  const checkToken = (payload: string) => {\r\n    return axios.post(endpoints.JWT_CHECK_TOKEN, { token: payload })\r\n      .then(response => {\r\n        return { user: response.data.user }\r\n      })\r\n      .catch(err => {\r\n        throw new Error(err.response.data[Object.keys(err.response.data)[0]][0])\r\n      })\r\n  }\r\n\r\n  const signUp = (payload: { email: string, phone: string}) => {\r\n    const { email, phone } = payload;\r\n    return axios.post(endpoints.SIGNUP, { email, phone })\r\n      .then(response => {\r\n        return response.data\r\n      })\r\n      .catch(err => {\r\n        throw new Error(err.response.data[Object.keys(err.response.data)[0]])\r\n      })\r\n  }\r\n\r\n  const checkAuth = (payload: string ) => {\r\n    const token = localStorage.getItem('token');\r\n    if (!token) {\r\n      throw new Error('Нет доступа')\r\n    }\r\n    return axios.post(endpoints.JWT_CHECK_TOKEN, { token })\r\n      .then(({ data }) => {\r\n        const { user } = data;\r\n        const { group } = user;\r\n\r\n        // TODO - in response group is number (id), must be a string\r\n        if (payload.indexOf(group) === -1) {\r\n          throw new Error('Нет доступа')\r\n        }\r\n        return user\r\n      })\r\n      .catch(err => {\r\n        throw new Error(err.message)\r\n      })\r\n  }\r\n\r\n  return {\r\n    logIn,\r\n    checkToken,\r\n    logOut,\r\n    signUp,\r\n    checkAuth\r\n  }\r\n}\r\n\r\nexport default {\r\n  create\r\n}","import { put, call } from 'redux-saga/effects';\r\n// import { push } from 'react-router-redux';\r\n// import Notifications from 'react-notification-system-redux';\r\n\r\nimport AuthActions from '../redux-sauce/auth'\r\n\r\nexport function * logIn (api, action) {\r\n  const { data } = action;\r\n  yield put(AuthActions.resetAuthErrors())\r\n  try {\r\n    let response = yield call(api.logIn, data)\r\n    yield put(AuthActions.loginSuccess(response))\r\n    yield put(AuthActions.toggleModal(false))\r\n  } catch (e) {\r\n    yield put(AuthActions.loginFailure(e.message))\r\n    // yield put(Notifications.error({ title: 'Ошибка', message: e.message, position: 'tc' }));\r\n  }\r\n}\r\n\r\nexport function * signUp (api, action) {\r\n  const { data } = action\r\n  try {\r\n    let response = yield call(api.signUp, data);\r\n    yield put(AuthActions.signupSuccess(response));\r\n    // yield put(push('/'));\r\n  } catch (e) {\r\n    yield put(AuthActions.signupFailure(e.message))\r\n    // yield put(Notifications.error({ title: 'Ошибка', message: e.message, position: 'tc' }));\r\n  }\r\n}\r\n\r\nexport function * logOut (api, action) {\r\n  try {\r\n    yield call(api.logOut)\r\n    yield put(AuthActions.logoutSuccess())\r\n  } catch (e) {\r\n    yield put(AuthActions.logoutFailure(e.message))\r\n    // yield put(Notifications.error({ title: 'Ошибка', message: e.message, position: 'tc' }));\r\n  }\r\n}\r\n\r\nexport function* checkToken(api, action) {\r\n  const { payload } = action;\r\n  try {\r\n    let response = yield call(api.checkToken, payload);\r\n    yield put(AuthActions.checkTokenSuccess(response));\r\n  } catch (e) {\r\n    yield put(AuthActions.checkTokenFail(e.message))\r\n  }\r\n}\r\n\r\nexport function* checkAuth(api, action) {\r\n  const { payload } = action;\r\n  try {\r\n    const response = yield call(api.checkAuth, payload);\r\n    yield put(AuthActions.checkAuthSuccess(response));\r\n  } catch (e) {\r\n    // yield put(push('/'));\r\n    // yield put(Notifications.error({ title: 'Ошибка', message: e.message, position: 'tc' }));\r\n    yield put(AuthActions.checkAuthFail(e.message))\r\n  }\r\n}","import { takeEvery, all, takeLatest } from \"redux-saga/effects\";\r\n\r\n/* -------------- API -------------- */\r\nimport AuthApi from \"../api/authApi\";\r\n\r\n/* ------------- Types ------------- */\r\nimport { AuthTypes } from \"../redux-sauce/auth\";\r\n\r\n/* ------------- Sagas ------------- */\r\nimport { logIn, logOut, checkToken, partialUpdateUser } from \"./authSagas\";\r\n// import * as feedbacksSaga from './feedbacksSagas';\r\n\r\nconst authApi = AuthApi.create();\r\n\r\nexport default function* root() {\r\n  yield all([\r\n    takeEvery(AuthTypes.LOGIN_REQUEST, logIn, authApi),\r\n    takeEvery(AuthTypes.LOGOUT_REQUEST, logOut, authApi),\r\n    takeEvery(AuthTypes.CHECK_TOKEN_REQUEST, checkToken, authApi),\r\n  ]);\r\n}\r\n","import { createStore, applyMiddleware, combineReducers } from 'redux'\r\nimport { composeWithDevTools } from 'redux-devtools-extension';\r\nimport createSagaMiddleware from 'redux-saga';\r\nimport rootSaga from '../sagas';\r\nimport { reducer as formReducer } from 'redux-form';\r\n\r\nexport const reducers = combineReducers({\r\n  auth: require('../redux-sauce/auth').reducer,\r\n  \r\n  form: formReducer,\r\n})\r\n\r\nexport default (history) => {\r\n  const sagaMiddleware = createSagaMiddleware();\r\n  const store = createStore(reducers, composeWithDevTools(\r\n    applyMiddleware(sagaMiddleware)\r\n  ));\r\n\r\n  let sagasManager = sagaMiddleware.run(rootSaga)\r\n\r\n  if (module.hot) {\r\n    module.hot.accept(() => {\r\n      const nextRootReducer = require('./').reducers\r\n      store.replaceReducer(nextRootReducer)\r\n\r\n      const newYieldedSagas = require('../sagas').default\r\n      sagasManager.cancel()\r\n      sagasManager.done.then(() => {\r\n        sagasManager = sagaMiddleware.run(newYieldedSagas)\r\n      })\r\n    })\r\n  }\r\n\r\n  return store\r\n}\r\n\r\n","import React, { } from 'react';\r\nimport { Field, reduxForm } from 'redux-form';\r\n\r\nimport TextField from '@material-ui/core/TextField';\r\n\r\nexport const renderTextField = ({\r\n  label,\r\n  placeholder,\r\n  input,\r\n  multiline,\r\n  meta: { touched, invalid, error },\r\n  labelClass,\r\n  ...custom\r\n}) => (\r\n  <TextField\r\n    fullWidth={true}\r\n    label={label}\r\n    placeholder={placeholder}\r\n    error={touched && invalid}\r\n    helperText={touched && error}\r\n    {...input}\r\n    {...custom}\r\n    multiline={multiline}\r\n    InputLabelProps={{\r\n      className: labelClass,\r\n    }}\r\n  />\r\n)\r\n\r\nexport function LoginForm (props) {\r\n  const { parentSubmit, pristine, reset, submitting, handleSubmit, eventFetching, eventError, message }\r\n     = props\r\n  return (\r\n    <div className='card card-style'>\r\n      <div className='content'>\r\n        <form onSubmit={handleSubmit(parentSubmit)} className='' > \r\n          <Field \r\n            component={renderTextField}\r\n            label=\"Логин\" \r\n            name='username'\r\n            margin='dense'\r\n          />\r\n\r\n          <Field \r\n            component={renderTextField}\r\n            label=\"Пароль\" \r\n            name='password'\r\n            margin='dense'\r\n            type='password'\r\n          />\r\n\r\n          <button \r\n            className='btn btn-m mt-2 font-900 shadow-s bg-highlight text-wrap'\r\n            type=\"submit\"\r\n            disabled={pristine || submitting}>\r\n            Войти\r\n          </button>\r\n\r\n          {/* <ErrorOrMessage error={eventError} message={message} fetching={eventFetching}\r\n              className='mt-2 mb-0 mx-1 font-15' /> */}\r\n        </form>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nconst validateLoginForm = values => {\r\n  const errors = {}\r\n  const requiredFields = [\r\n    'username',\r\n    'password'\r\n  ]\r\n  \r\n  requiredFields.forEach(field => {\r\n    if (!values[field]) {\r\n      errors[field] = 'Обязательное поле'\r\n    }\r\n  })\r\n  return errors\r\n}\r\n\r\nLoginForm = reduxForm({\r\n  form: 'loginForm',\r\n  validate: validateLoginForm,\r\n})(LoginForm)\r\n\r\n\r\nexport function DateFilter(props) {\r\n  const { startDate, endDate, setData, showResults } = props\r\n  return (\r\n    <div className='d-flex justify-content-between'>\r\n      <TextField\r\n        label={'Дата с'}\r\n        type=\"date\"\r\n        name='startDate'\r\n        className='mr-2'\r\n        value={startDate}\r\n        onChange={setData}\r\n        InputLabelProps={{\r\n          className: '',\r\n          shrink: true \r\n        }}\r\n      />\r\n      <TextField\r\n        label={'Дата до'}\r\n        type=\"date\"\r\n        name='endDate'\r\n        className='mr-2'\r\n        value={endDate}\r\n        onChange={setData}\r\n        InputLabelProps={{\r\n          className: '',\r\n          shrink: true \r\n        }}\r\n      />\r\n      <button className='btn btn-xs bg-highlight' onClick={showResults}>\r\n        показать\r\n      </button>\r\n    </div>\r\n  )\r\n} \r\n\r\nexport function DayFilter(props) {\r\n  const { date, setData, showResults } = props\r\n  return (\r\n    <div className='d-flex justify-content-between'>\r\n      <TextField\r\n        type=\"date\"\r\n        name='date'\r\n        className='mr-2'\r\n        value={date}\r\n        onChange={setData}\r\n        InputLabelProps={{\r\n          className: '',\r\n          shrink: true \r\n        }}\r\n      />\r\n      <button className='btn btn-xs bg-highlight' onClick={showResults}>\r\n        показать\r\n      </button>\r\n    </div>\r\n  )\r\n} "," import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { CircularProgress } from '@material-ui/core'\r\n\r\nimport AuthActions from '../redux/redux-sauce/auth';\r\n\r\nimport { LoginForm } from '../components/CommonForms';\r\n\r\n\r\nexport function MenuItem (props) {\r\n  let history = useHistory()\r\n\r\n  function handleClick() {\r\n    history.push(props.to);\r\n  }\r\n  return (\r\n    <div \r\n      className='card-style mx-5 my-3 pt-2'\r\n      onClick={handleClick}\r\n      style={{\r\n        'background': 'white',\r\n        'width': '300px',\r\n        'color': 'white',\r\n        'font-weight': 'bold',\r\n        'font-size': '1em',\r\n        'text-align': 'center',\r\n        'word-break': 'break-word',\r\n        'border-radius': '15px',\r\n        'line-height': '12px',\r\n      }}\r\n    >\r\n      <h5>{props.title}</h5>\r\n    </div>\r\n  )\r\n}\r\n\r\nfunction ShopMenu (props) {\r\n  const { user } = props\r\n  props.setShopToSee(user.can_see_shop_stock)\r\n\r\n  return (\r\n    <div className=' '>\r\n      <div className='my-4'>\r\n        <h3 className='text-center'>Склад</h3>\r\n        <MenuItem title={'Склад. Текущие остатки'} to={'/manager/stock/'}/>\r\n      </div>\r\n\r\n      <div className='my-4'>\r\n        <h3 className='text-center'>Приход пиломатериалов</h3>\r\n          <MenuItem title={'Приход список'} to={'/manager/shift_list/'}/>\r\n          <MenuItem title={'Создать приход'} to={'/manager/shift/create_shift/'}/>\r\n      </div>     \r\n\r\n      {/* {user.is_manager &&\r\n        <div className='my-4'>\r\n          <MenuItem title={'Перепил'} to={'/manager/resaws/create/'}/>\r\n        </div>\r\n      } */}\r\n     \r\n      <div className='my-4'>\r\n        <h3 className='text-center'>Продажи</h3>\r\n        <MenuItem title={'Создать продажу'} to={'/manager/sales/create_sale/'}/>\r\n        <MenuItem title={'Продажи список'} to={'/manager/sale_list/'}/>\r\n      </div>\r\n      \r\n      <div className='my-4'>\r\n        <h3 className='text-center'>Отчеты и расходы</h3>\r\n        <MenuItem title={'Расходы'} to={'/manager/expenses/'}/>\r\n        <MenuItem title={'Расчет поставщиков'} to={'/manager/ramshik_payments/'}/>\r\n        <MenuItem title={'Итоги за день'} to={'/manager/daily_report/'}/>\r\n      </div>\r\n\r\n    </div>\r\n  )\r\n\r\n}\r\n\r\n\r\nclass Main extends Component {\r\n  constructor(props) { \r\n    super(props);\r\n    this.state = {\r\n      username: '',\r\n      password: '',\r\n    }\r\n  }\r\n\r\n  login = () => {\r\n    this.props.login(this.props.form.values)\r\n  }\r\n\r\n  render() {\r\n    const { isLoggedIn, fetching, user, shopToSee } = this.props.state.auth\r\n    \r\n    return (\r\n      fetching \r\n        ? <CircularProgress />\r\n        : isLoggedIn \r\n            ? <ShopMenu user={user} shopToSee={shopToSee} setShopToSee={this.props.setShopToSee}/>\r\n            : <LoginForm parentSubmit={this.login} />\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => ({\r\n  routing: state.routing,\r\n  state: state,\r\n  form: state.form.loginForm\r\n})\r\n\r\nconst mapDispatchToProps = (dispatch) => ({\r\n  login: (payload) => dispatch(AuthActions.loginRequest(payload)),\r\n  logout: (payload) => dispatch(AuthActions.logoutRequest(payload)),\r\n  checkToken: (token) => dispatch(AuthActions.checkTokenRequest(token)),\r\n  setShopToSee: (shop) => dispatch(AuthActions.setShopToSee(shop))\r\n})\r\n\r\nexport default connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n)(Main);\r\n","import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { useHistory  } from \"react-router-dom\";\r\n\r\n// actions\r\nimport AuthActions from '../redux/redux-sauce/auth';\r\n\r\n\r\nfunction HeaderComp (props) {\r\n  const histoty = useHistory()\r\n\r\n  function handleClickLogout () {\r\n    props.logout()\r\n    histoty.push('/')\r\n  }\r\n\r\n  function handleClickMenu () {\r\n    histoty.push('/')\r\n  }\r\n\r\n  function toMain () {\r\n    props.setShopToSee({})\r\n    histoty.push('/')\r\n  }\r\n\r\n  return (\r\n    <div className='d-flex justify-content-between px-3 py-2'>\r\n      <h4 className='text-center pt-2 w-100 pl-4' onClick={handleClickMenu}>{props.shopToSee.name}</h4>\r\n      <button className='btn btn-xs bg-red1-light' style={{lineHeight: '13px'}} onClick={handleClickLogout}>\r\n        <span className='py-0 my-0'>\r\n          <span className='d-block'>{props.user.nickname}</span>\r\n          выйти\r\n        </span>\r\n      </button>\r\n    </div>\r\n  )\r\n}\r\n\r\nclass Header extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      modalOpen: false,\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    const token = localStorage.getItem('token');\r\n    if (token) {\r\n      this.props.checkToken(token);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const { isLoggedIn, fetching, user, shopToSee } = this.props.auth\r\n\r\n    return (\r\n      user\r\n      ? <div className='header' >\r\n          <HeaderComp logout={this.props.logout} user={user} shopToSee={shopToSee} \r\n            setShopToSee={this.props.setShopToSee}/>\r\n        </div>\r\n      : 'net login'\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => ({\r\n  state: state,\r\n  auth: state.auth,\r\n  routing: state.routing,\r\n})\r\n\r\nconst mapDispatchToProps = (dispatch) => ({\r\n  checkToken: (token) => dispatch(AuthActions.checkTokenRequest(token)),\r\n  logout: () => dispatch(AuthActions.logoutRequest()),\r\n  setShopToSee: (shop) => dispatch(AuthActions.setShopToSee(shop))\r\n})\r\n\r\nexport default connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n)(Header);","\r\n// standart serializer field error. There are could be several fields\r\n// {\r\n//     \"birth_id\": [\"This field is required.\"]\r\n// }\r\n\r\n\r\nexport const parseErrorData = (error) => {\r\n\r\n    if (error && typeof error.response !== 'undefined') {\r\n        let errorObj = {\r\n            status: error.response.status, \r\n            statusText: error.response.statusText,\r\n            message: null,\r\n            response: error.response,\r\n        }\r\n        if ('message' in error.response.data) {\r\n            errorObj.message = JSON.stringify(error.response.data.message)\r\n        }\r\n        else {\r\n            let message = ''\r\n            for (const property in error.response.data) {\r\n                message = message + `${property}: ${error.response.data[property]}. `\r\n              }\r\n            errorObj.message = message\r\n\r\n        }\r\n        return errorObj\r\n\r\n    } else {\r\n        return { \r\n         status: 'Connection Error',\r\n         statusText: 'An error occurred while sending your data!',\r\n         message: 'An error occurred while sending your data!' }\r\n    }\r\n}\r\n\r\nexport const createUrlParamsFromFilters = (filters) => {\r\n    const params = new URLSearchParams()\r\n\r\n    if (filters != null) Object.keys(filters).forEach(key => {\r\n            if (filters[key] !== null && !(filters[key] instanceof Array)) \r\n                params.append(key, filters[key])\r\n            if (filters[key] !== null && filters[key] instanceof Array){\r\n                delete params[key]\r\n                filters[key].map(value => {\r\n                    if (value !== '')\r\n                        params.append(key, value)\r\n                    return null\r\n                })\r\n            }\r\n        })\r\n    return params\r\n}","import _ from 'lodash';\r\n\r\nexport const toggleArray = (arr: Array<String>, string: string) => {\r\n    if (arr.indexOf(string) === -1) {\r\n      return [...arr, string]\r\n    } else {\r\n      return arr.filter(item => item !== string)\r\n    }\r\n  }\r\n\r\nexport const lodashToggle = (array, item) => _.xor(array, [item])\r\n\r\nexport const toggleArrayLocations = (arr: Array<Object>, location: Object) => {\r\n  let alreadyIn = false;\r\n  let index = -1;\r\n  for (var i = 0; i < arr.length; i++){\r\n    if (_.isEqual(arr[i], location)){\r\n      alreadyIn = true;\r\n      index = i;\r\n      break;\r\n    }\r\n  }\r\n\r\n  if (alreadyIn){\r\n    arr.splice(index, 1);\r\n    return arr\r\n  } else {\r\n    return [...arr, location]\r\n  }\r\n}\r\n\r\nexport const addItemToArray = (arr: Array<String>, string: string) => {\r\n    return [...arr, string]\r\n  }\r\n\r\nexport const removeItemFromArray = (arr: Array<String>, string: string) => {\r\n    return arr.filter(item => item !== string)\r\n}\r\n\r\nexport const uniq = a => [...new Set(a)]\r\n\r\n\r\nexport const getObjectbyId = (list, id) => {\r\n  let obj = null\r\n  list.map(element => {\r\n    if (element['id'] == id)\r\n      obj = element\r\n  })\r\n  return obj\r\n}\r\n\r\nexport const getObjectInListbyFieldValue = (list, field, value) => {\r\n  let obj = null\r\n  list.map(element => {\r\n    if (element[field] == value)\r\n      obj = element\r\n  })\r\n  return obj\r\n}\r\n\r\nexport const toggleArrayDictById= (arr: Array<Object>, obj: Object) => {\r\n  let alreadyIn = false;\r\n  let index = -1;\r\n\r\n  for (var i = 0; i < arr.length; i++){\r\n    if (arr[i].id === obj.id){\r\n      alreadyIn = true;\r\n      index = i;\r\n      break;\r\n    }\r\n  }\r\n\r\n  if (alreadyIn){\r\n    arr.splice(index, 1);\r\n    return arr\r\n  } else {\r\n    return [...arr, obj]\r\n  }\r\n}\r\n\r\nexport function replaceItemInDictArrayById(list, item) {\r\n  const itemInList = getObjectbyId(list, item.id)\r\n  const index = list.indexOf(itemInList)\r\n  list = [\r\n    ...list.slice(0, index),\r\n    item,\r\n    ...list.slice(index + 1)\r\n  ]\r\n  return list\r\n}\r\n\r\nexport function getToday() {\r\n  let today = new Date();\r\n  let dd = String(today.getDate()).padStart(2, '0');\r\n  let mm = String(today.getMonth() + 1).padStart(2, '0');\r\n  let yyyy = today.getFullYear();\r\n\r\n  today = yyyy + '-' + mm + '-' + dd;\r\n  return today\r\n}\r\n\r\nexport function jsDateTimeToStr (jsDate) {\r\n  let dd = String(jsDate.getDate()).padStart(2, '0');\r\n  let mm = String(jsDate.getMonth() + 1).padStart(2, '0');\r\n  let yyyy = jsDate.getFullYear();\r\n  let hours = jsDate.getHours();\r\n  let minutes = jsDate.getMinutes() > 9 ? jsDate.getMinutes(): '0' + jsDate.getMinutes();\r\n  return yyyy + '-' + mm + '-' + dd + 'T' + hours + ':' + minutes\r\n  \r\n}\r\n\r\nexport function jsDateTimeToStrDate (jsDate) {\r\n  let dd = String(jsDate.getDate()).padStart(2, '0');\r\n  let mm = String(jsDate.getMonth() + 1).padStart(2, '0');\r\n  let yyyy = jsDate.getFullYear();\r\n  return yyyy + '-' + mm + '-' + dd \r\n  \r\n}","import React, { } from 'react';\r\n\r\n\r\nfunction ShiftLumberTr (props) {\r\n  const { record } = props\r\n  const measureClass = 'font-10'\r\n  return (\r\n    <tr>\r\n      <td style={{lineHeight: '15px'}}>\r\n        {record.wood_species === 'larch'  \r\n          ? <span className='d-block color-brown1-light'>листв</span>\r\n          : <span className='d-block color-green1-light'>сосна</span>\r\n        }\r\n        {record.lumber.includes('доска') \r\n          ? <span className='font-italic'>{record.lumber}</span>\r\n          : <span className=''>{record.lumber}</span>\r\n        }\r\n      </td>\r\n      <td>\r\n        {record.quantity}\r\n        <span className={measureClass}> шт</span>\r\n      </td>\r\n      <td>{record.volume}<span className={measureClass}> м3</span></td>\r\n      <td>{record.rate}<span className={measureClass}> р</span></td>\r\n      <td>{record.total_cash}<span className={measureClass}> р</span></td>\r\n    </tr>\r\n  )\r\n}\r\n\r\nexport function ShiftComponent (props) {\r\n  const { shift, user, deleteShift } = props\r\n  return (\r\n    <div className='card card-style'>\r\n      <div className='content mb-1'>\r\n        <div className='d-flex justify-content-between'>\r\n          <p className='color-black mb-0 font-16'>Дата: {shift.date} {shift.shift_type}</p>\r\n          <button className='btn btn-s bg-red1-light mr-2 text-uppercase' \r\n            onClick={() => deleteShift(shift.id)}>\r\n              удалить\r\n          </button>\r\n        </div>\r\n        <p className='color-black mb-0 font-13 d-flex justify-content-between' style={{lineHeight: '15px'}}>\r\n          <span className='d-block mb-1'>Поставщик: <span className='d-block font-600 font-14'>{shift.employees[0]}</span></span>\r\n          <span className='d-block mb-1'>Объем: <span className='d-block font-600 font-14'>{shift.volume} m3</span></span>          \r\n          <span>Общая сумма: <span className='d-block font-600 font-14'>{shift.back_calc_cash} р</span></span>\r\n        </p>\r\n      </div>\r\n      <div className='content mt-0'>\r\n        <table className='table table-sm'>\r\n          <thead>\r\n            <th>Пиломат</th>\r\n            <th>кол-во</th>\r\n            <th>объем</th>\r\n            <th>цена</th>\r\n            <th>сумма</th>\r\n          </thead>\r\n          <tbody>\r\n            {shift.lumber_records.map(record => \r\n              <ShiftLumberTr record={record}/>\r\n            )}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport function ShiftList (props) {\r\n  const { shiftList, user, deleteShift } = props\r\n  return (\r\n    <div className='mt-2'>\r\n      <h4 className='my-3 text-center'>Смены  ({shiftList.length})</h4>\r\n      {shiftList.length > 0 && shiftList.map(shift => \r\n          <ShiftComponent shift={shift} user={user} deleteShift={deleteShift}/>\r\n      )}\r\n    </div>\r\n  )\r\n}","import axios from 'axios';\r\n\r\nimport React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\n\r\nimport { createUrlParamsFromFilters } from '../../redux/api/utils';\r\nimport { jsDateTimeToStrDate } from '../../components/utils';\r\nimport endpoints from '../../redux/api/endpoints';\r\nimport { ShiftList } from '../../components/Shifts';\r\nimport { DateFilter } from '../../components/CommonForms';\r\n\r\n\r\nexport class ManagerShiftList extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      shiftList: [],\r\n\r\n      startDate: '',\r\n      endDate: '',\r\n      \r\n      message: null,\r\n      error: null,\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    const token = localStorage.getItem('token');\r\n    let today = new Date()\r\n    let yesterday = new Date()\r\n    yesterday.setDate(today. getDate() - 1);\r\n    let startDate = jsDateTimeToStrDate(yesterday)\r\n    let endDate = jsDateTimeToStrDate(today)\r\n    const params = createUrlParamsFromFilters({shop: this.props.shopToSee.id, \r\n      date_before: endDate, date_after:startDate});\r\n    axios({\r\n      method: 'get',\r\n      url: endpoints.SHIFTS,\r\n      headers: {'Authorization': `JWT ${token}` },\r\n      params: params\r\n    })\r\n    .then(response => {\r\n      this.setState({ ...this.state, shiftList: response.data.results, startDate: startDate, endDate: endDate });\r\n    })\r\n  }\r\n\r\n  setData = (e) => {\r\n    this.setState({\r\n      [e.target.name]: e.target.value \r\n    })\r\n  }\r\n\r\n  showResults = () => {\r\n    const token = localStorage.getItem('token');\r\n    const params = createUrlParamsFromFilters({shop: this.props.shopToSee.id, \r\n      date_before: this.state.endDate, date_after: this.state.startDate});\r\n    axios({\r\n      method: 'get',\r\n      url: endpoints.SHIFTS,\r\n      headers: {'Authorization': `JWT ${token}` },\r\n      params: params\r\n    })\r\n    .then(response => {\r\n      this.setState({ ...this.state, shiftList: response.data.results, });\r\n    })\r\n  }\r\n\r\n  deleteShift = (id) => {\r\n    const token = localStorage.getItem('token');\r\n    axios({\r\n      method: 'delete',\r\n      url: endpoints.manager_shift_delete(id),\r\n      headers: { 'content-type': 'application/JSON', 'Authorization': `JWT ${token}` }\r\n    })\r\n    .then(response => {\r\n      this.setState({ shiftList: response.data.shifts });\r\n    })\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <div className='card card-style mt-2'>\r\n          <div className='content'>\r\n            <DateFilter startDate={this.state.startDate} endDate={this.state.endDate} setData={this.setData}\r\n              showResults={this.showResults}/>\r\n          </div>\r\n        </div>\r\n        <ShiftList shiftList={this.state.shiftList} user={this.props.user} deleteShift={this.deleteShift}/>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\n\r\nconst mapStateToProps = (state) => ({\r\n  isLoggedIn: state.auth.isLoggedIn,\r\n  user: state.auth.user,\r\n  shopToSee: state.auth.shopToSee,\r\n  state: state\r\n});\r\n\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n})\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ManagerShiftList);","import axios from 'axios';\r\n\r\nimport React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\n\r\nimport Switch from '@material-ui/core/Switch';\r\nimport TextField from '@material-ui/core/TextField';\r\n\r\nimport endpoints from '../../redux/api/stockPageApi';\r\nimport { replaceItemInDictArrayById, getObjectbyId } from '../../components/utils';\r\n\r\n\r\nconst stockApi = endpoints.create();\r\n\r\nfunction TrRow (props) {\r\n  let { lumber, showNull, changeMarketCost, user } = props\r\n  let show = true\r\n  if (lumber.current_stock_quantity == 0 && !showNull) {\r\n    show = false\r\n  }\r\n  let wood_species = lumber.wood_species === 'pine' ? 'сосна' : 'лиственница'\r\n  let woodSpeciesClass = wood_species === 'сосна' ? 'color-green1-light' : 'color-brown1-light'\r\n  return (\r\n    show &&\r\n      <tr>\r\n        <td>\r\n          {lumber.name}\r\n          <span className={'d-block font-italic font-500 ' + woodSpeciesClass}>{wood_species}</span>\r\n        </td>\r\n        <td>\r\n          <span className='font-16'>{lumber.current_stock_volume.toFixed(4)}</span>\r\n          <span className='d-block'>м3</span>\r\n        </td>\r\n        <td>\r\n          <span className='font-16'>{lumber.current_stock_quantity}</span>\r\n          шт\r\n        </td>\r\n        <td>\r\n          {user.is_manager &&\r\n            <TextField type='number' \r\n              className=''\r\n              value={lumber.shop_rate > 0 && lumber.shop_rate} \r\n              onChange={(e) => changeMarketCost(e, lumber.id)}/>\r\n          }\r\n          {user.is_kladman && <span className='font-16'>{lumber.shop_rate}</span>}\r\n        </td>\r\n        <td>\r\n          <span className='font-16'>\r\n            {lumber.stock_total_cash.toFixed(0)}</span>\r\n            р\r\n        </td>\r\n      </tr>\r\n  )\r\n}\r\n\r\nexport class ManagerStock extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      lumbers: [],\r\n      showNull: false,\r\n\r\n      message: null,\r\n      error: null,\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    stockApi.getStock({shop: this.props.shopToSee.id}).then(data => {\r\n      this.setState({ lumbers: data.results });\r\n    })\r\n  }\r\n\r\n  changeMarketCost = (e, lumberId) => {\r\n    let { lumbers } = this.state\r\n    let lumber = getObjectbyId(lumbers, lumberId)\r\n   \r\n    stockApi.setLumberPrice({\r\n      lumber: lumberId,\r\n      shop_rate: parseInt(e.target.value) || 0\r\n    })\r\n    .then(data => {\r\n      lumber = data;\r\n    })\r\n\r\n    lumber.shop_rate = parseInt(e.target.value) || 0\r\n    lumber.stock_total_cash = lumber.shop_rate * lumber.current_stock_volume\r\n\r\n    lumbers = replaceItemInDictArrayById(lumbers, lumber)\r\n    this.setState({\r\n      lumbers: lumbers\r\n    })\r\n  }\r\n\r\n  render() {\r\n    const { lumbers, showNull } = this.state\r\n    let totalVolume = 0\r\n    let totalCash = 0\r\n    lumbers.map(lumber => {\r\n      totalVolume += lumber.current_stock_volume\r\n      totalCash += lumber.stock_total_cash\r\n    })\r\n    return (\r\n      <div className='mt-2'>\r\n        <div className='card card-style mb-2'>\r\n          <div className='content'>\r\n            <div className='d-flex justify-content-between'>\r\n              <h4 className='mb-2'>Склад</h4>\r\n              <div className='my-0'>\r\n                <label>Показать нулевые значения</label>\r\n                <Switch\r\n                  checked={this.state.showNull}\r\n                  onChange={() => this.setState({showNull: !this.state.showNull})}\r\n                  name=\"showNull\"\r\n                />\r\n              </div>\r\n            </div>\r\n            <div className='d-flex justify-content-start'>\r\n              {lumbers.length > 0 &&\r\n                <table className='table table-sm table-responsive' style={{lineHeight: '17px'}}>\r\n                  <thead>\r\n                    <th>пиломат</th>\r\n                    <th>объем</th>\r\n                    <th>кол-во</th>\r\n                    <th>цена за 1м3</th>\r\n                    <th>стоимоcть общая</th>\r\n                  </thead>\r\n                  <tbody>\r\n                    {lumbers.map(lumber =>\r\n                      <TrRow lumber={lumber} showNull={showNull} changeMarketCost={this.changeMarketCost}\r\n                        user={this.props.user}/>\r\n                      )}\r\n                    <tr>\r\n                      <td><span className='font-16 font-500'>Итого</span></td>\r\n                      <td>\r\n                        <span className='font-16 font-500'>{totalVolume.toFixed(3)}</span>\r\n                        <span className='d-block'>м3</span>\r\n                      </td>\r\n                      <td></td>\r\n                      <td></td>\r\n                      <td>\r\n                        <span className='font-16 font-500'>{totalCash.toFixed(0)}</span>\r\n                        <span className='d-block'>рублей</span>\r\n                        </td>\r\n                    </tr>\r\n                  </tbody>\r\n                </table>\r\n              }\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\n\r\nconst mapStateToProps = (state) => ({\r\n  user: state.auth.user,\r\n  shopToSee: state.auth.shopToSee\r\n})\r\n\r\nconst mapDispatchToProps = (dispatch) => ({\r\n  dispatch: dispatch,\r\n})\r\n\r\nexport default connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n)(ManagerStock);","import axios from 'axios';\r\nimport endpoints from './endpoints';\r\nimport { parseErrorData, createUrlParamsFromFilters } from './utils';\r\n\r\nconst create = () => {\r\n    const getStock = (filters) => {\r\n        const token = localStorage.getItem('token');\r\n        const params = createUrlParamsFromFilters(filters);\r\n        return axios({\r\n            method: 'get',\r\n            url: endpoints.STOCK,\r\n            params: params,\r\n            headers: {'Authorization': `JWT ${token}` }\r\n          })\r\n        .then(response => response.data)\r\n        .catch(err => {\r\n            const error = new Error(err);\r\n            error.data = parseErrorData(err);\r\n            throw error;\r\n        })\r\n    }\r\n\r\n    const setLumberPrice = payload => {\r\n        // const { med_type, med_method, drug, doze } = payload;\r\n        const token = localStorage.getItem('token') || '';\r\n        const url = endpoints.MANAGER_STOCK_SET_LUMBER_PRICE;\r\n\r\n        // const formData = new FormData();\r\n        // formData.append(\"med_type\", med_type);\r\n        // formData.append(\"med_method\", med_method);\r\n        // doze && formData.append(\"doze\", doze);\r\n        // formData.append(\"drug\", drug);\r\n        \r\n        return axios({\r\n                    method: 'post',\r\n                    url: url,\r\n                    data: payload,\r\n                    headers: { 'content-type': 'application/JSON', 'Authorization': `JWT ${token}` }\r\n        })\r\n        .then(response => {\r\n            return response.data\r\n        })\r\n        .catch(err => {\r\n            const error = new Error(err);\r\n            error.data = parseErrorData(err);\r\n            throw error;\r\n        })\r\n    }  \r\n\r\n    return {\r\n        getStock,\r\n        setLumberPrice\r\n    }\r\n}\r\n\r\nexport default {\r\n    create\r\n}","import React, { } from 'react';\r\n\r\nfunction FilteredLumberTr (props) {\r\n  const { lumber, calcType, calcRowAndTotal, key } = props\r\n  let tr = \r\n    <tr key={key}>\r\n      <td>\r\n        {lumber.name} \r\n        {lumber.wood_species === 'pine' \r\n          ? <span className='d-block color-brown1-light'>сосна</span> \r\n          : <span className='d-block color-green2-light'>лиственница</span>}\r\n      </td>\r\n      <td className='w-25'>\r\n        <input style={{'color': '#6c6c6c'}}\r\n          name='quantity'\r\n          type='number' className='w-75' onChange={(e) => calcRowAndTotal(e, lumber)} \r\n          value={lumber.quantity > 0 && lumber.quantity}/>\r\n      </td>\r\n      <td>{lumber.volume_total > 0 && lumber.volume_total.toFixed(4) + ' м3'}</td>\r\n      <td className='w-25'>\r\n        <input style={{'color': '#6c6c6c'}}\r\n          name='rate'\r\n          type='number' className='w-100' onChange={(e) => calcRowAndTotal(e, lumber)} \r\n          value={lumber.employee_rate > 0 && lumber.employee_rate}/>\r\n      </td>\r\n      <td>{lumber.cash > 0 && lumber.cash.toFixed(0) + ' руб'}</td>\r\n    </tr>\r\n  \r\n  if (calcType === 'mixed' ) {\r\n    if ((lumber.lumber_type !== 'doska' & lumber.wood_species === 'larch') | ( lumber.wood_species === 'pine'))\r\n      return tr\r\n    }\r\n  \r\n  if (calcType === 'sorted' ) {\r\n      return tr\r\n    }\r\n  return null\r\n}\r\n\r\nexport function LumberTableMixed (props) {\r\n  const { lumbers, calcRowAndTotal, totalVolume, totalCash, calcType } = props\r\n\r\n  return (\r\n    <table className='table table-sm table-responsive text-center' \r\n      style={{'lineHeight': '17px', 'color': '#6c6c6c'}}>\r\n      <thead>\r\n        <th>Изделие</th>\r\n        <th>Кол-во</th>\r\n        <th>Обьем</th>\r\n        <th>Цена</th>\r\n        <th>Сумма</th>\r\n      </thead>\r\n      <tbody>\r\n      {lumbers.map((lumber, key) => \r\n        <FilteredLumberTr lumber={lumber} calcType={calcType} calcRowAndTotal={calcRowAndTotal} key={key}/>\r\n        )}\r\n        <tr>\r\n          <td>Итого</td>\r\n          <td className='w-25'>\r\n            -\r\n          </td>\r\n          <td>\r\n            <span className='font-17 font-600'>\r\n              {totalVolume > 0 && totalVolume.toFixed(4) + ' м3'}\r\n            </span>\r\n          </td>\r\n          <td>-</td>\r\n          <td>\r\n            <span className='font-17 font-600'>\r\n              {totalCash > 0 && totalCash.toFixed(0) + ' руб'}\r\n            </span>\r\n          </td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n  )\r\n}\r\n\r\nexport function LumberTable (props) {\r\n  const { lumbers } = props\r\n  return(\r\n    <table className='table table-sm table-responsive mt-2'>\r\n      <thead>\r\n        <th>\r\n          Пиломат\r\n        </th>\r\n        <th>\r\n          кол-во\r\n        </th>\r\n        <th>\r\n          объем\r\n        </th>\r\n        <th>\r\n          цена за м3\r\n        </th>\r\n        <th>\r\n          сумма\r\n        </th>\r\n      </thead>\r\n      <tbody>\r\n        {lumbers.map(lumber_record =>\r\n        <tr>\r\n          <td>\r\n            {lumber_record.name ? lumber_record.name : lumber_record.lumber}\r\n          </td>\r\n          <td>{lumber_record.quantity} шт</td>\r\n          <td>\r\n            {lumber_record.volume_total \r\n              ? lumber_record.volume_total.toFixed(4) + 'м3' : lumber_record.volume.toFixed(4) + 'м3'}\r\n          </td>\r\n          <td>{lumber_record.rate || lumber_record.employee_rate} руб</td>\r\n          <td>{(lumber_record.total_cash || lumber_record.cash).toFixed(0)} руб</td>\r\n        </tr>\r\n          )}\r\n      </tbody>\r\n    </table>\r\n  )\r\n}\r\n\r\nexport function ShiftToSave (props) {\r\n  const { shift, saveData, back } = props\r\n  const rowClass = 'mb-0 font-15 font-500 color-black'\r\n  return (\r\n    <div className='card card-style my-2'>\r\n      <div className='content'>\r\n      <h4>Проверяем данные</h4>\r\n      {shift &&\r\n        <div className=''>\r\n          <p className={rowClass}>\r\n            Объем общий: {shift.volume.toFixed(4)} м3</p>\r\n          <p className={rowClass}>\r\n            Общая сумма: {shift.employee_cash.toFixed(1)} рублей</p>\r\n          <p className={rowClass}>Примечание: {shift.note}</p>\r\n\r\n          <LumberTable lumbers={shift.raw_records}/>\r\n        </div>\r\n        }\r\n        <div className='d-flex justify-content-around'>\r\n          <button onClick={back}\r\n            className='btn btn-m text-uppercase font-900 bg-dark color-white rounded-sm shadow-l'>\r\n            назад\r\n          </button>\r\n          <button onClick={saveData}\r\n            className='btn btn-m text-uppercase font-900 bg-highlight rounded-sm shadow-l'>\r\n              Сохранить данные\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport function CreatedShift (props) {\r\n  const { shift, message } = props\r\n  const rowClass = 'mb-0 font-15 font-500 color-black'\r\n  return (\r\n    <div className='card card-style my-2'>\r\n      <div className='content'>\r\n        <h4>Приход сохранен</h4>\r\n        {shift &&\r\n          <div className=''>\r\n            <p className={rowClass}>Дата: {shift.date}</p>\r\n            <p className={rowClass}>\r\n              Объем общий: {shift.volume.toFixed(2)}  ({shift.back_calc_volume.toFixed(2)}) м3</p>\r\n            <p className={rowClass}>\r\n              Общая сумма: {shift.employee_cash && shift.employee_cash.toFixed(1)} ({shift.back_calc_cash.toFixed(1)}) \r\n              рублей</p>\r\n            <p className={rowClass}>Примечание: {shift.note}</p>\r\n            <LumberTable lumbers={shift.lumber_records}/>\r\n          </div>\r\n        }\r\n        {message &&\r\n          <h2 className='color-green1-light text-center'>Данные сохранены!</h2> \r\n        }\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport function EmployeesBlock (props) {\r\n  const { totalCash, employees, activeEmployees, addEmployee } = props\r\n  const empClass = ' rounded-xs px-2 py-2 '\r\n  return (\r\n    <div className='content'>\r\n      <h4>Кто поставщик? {activeEmployees.length > 0 && '(' + activeEmployees.length + ')'}</h4>\r\n      <div className='d-flex justify-content-between my-2 flex-wrap'>\r\n        {employees.map(emp => \r\n          <div \r\n            className={activeEmployees.includes(emp) \r\n              ? 'bg-green2-light mx-1 my-1' + empClass : 'bg-dark1-dark mx-1 my-1' + empClass }\r\n             onClick={() => addEmployee(emp)}>\r\n            {emp.nickname}\r\n          </div>\r\n          )}\r\n      </div>\r\n      {activeEmployees.length > 0 && \r\n        <div>\r\n          <div className='d-flex justify-content-start'>\r\n            {activeEmployees.map(aEmp => \r\n              <div className='mx-2'>\r\n                <span className='d-block font-16'>{aEmp.nickname}</span>\r\n                {totalCash > 0 && \r\n                  <span className='font-17 font-600'> {(totalCash / activeEmployees.length).toFixed(0)} руб</span>\r\n                }\r\n              </div>\r\n              )}\r\n          </div>\r\n        </div>\r\n      }\r\n    </div>\r\n  )\r\n}","import axios from 'axios';\r\n\r\nimport React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\n\r\nimport endpoints from '../../redux/api/endpoints';\r\nimport { replaceItemInDictArrayById, lodashToggle, toggleArrayDictById } from '../../components/utils';\r\nimport { ShiftToSave, CreatedShift, LumberTableMixed, EmployeesBlock } from '../../components/ShiftCreateComponent';\r\n\r\n\r\nexport class ShiftCreateComponent extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      lumbers: [],\r\n      initLumbers: [],\r\n      totalVolume: 0,\r\n      totaCash: 0,\r\n\r\n      createdShift: null,\r\n\r\n      employees: [],\r\n      activeEmployees: [],\r\n\r\n      dataToSave: null,\r\n\r\n      calcType: 'mixed',\r\n\r\n      message: null,\r\n      error: null,\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    const token = localStorage.getItem('token');\r\n    axios(\r\n      {\r\n        method: 'get',\r\n        url: endpoints.MANAGER_SHIFT_CREATE_DATA,\r\n        headers: { 'Authorization': `JWT ${token}` }\r\n      }\r\n    ).then(res => {\r\n        const initData = res.data;\r\n        this.setState({ lumbers: initData.lumbers, initLumbers: initData.lumbers, \r\n          employees: initData.employees });\r\n      })\r\n  }\r\n\r\n  calcRowQuantity = (lumber, qnty) => {\r\n    let calcLumber = {\r\n      ...lumber,\r\n      lumber: lumber.id,\r\n      quantity: qnty,\r\n      volume_total: qnty * lumber.volume,\r\n      cash: qnty * lumber.volume * lumber.employee_rate,\r\n      employee_rate: lumber.employee_rate\r\n    }\r\n    return calcLumber\r\n  }\r\n\r\n  calcRowRate = (lumber, rate) => {\r\n    let calcLumber = {\r\n      ...lumber,\r\n      lumber: lumber.id,\r\n      quantity: lumber.quantity,\r\n      volume_total: lumber.quantity * lumber.volume,\r\n      cash: lumber.quantity * lumber.volume * rate,\r\n      employee_rate: rate\r\n    }\r\n    return calcLumber\r\n  }\r\n\r\n  calcTotalVolume = (lumbers) => {\r\n    let totalVolumeVar = 0\r\n\r\n    lumbers.map(lumber => {\r\n      totalVolumeVar = totalVolumeVar + lumber.volume_total\r\n    })\r\n\r\n    return totalVolumeVar\r\n  }\r\n\r\n  calcTotalCash = (lumbers) => {\r\n    let totalCashVar = 0\r\n\r\n    lumbers.map(lumber => {\r\n      totalCashVar = totalCashVar + lumber.cash\r\n    })\r\n\r\n    return totalCashVar\r\n  }\r\n\r\n  calcRowAndTotal = (e, lumber) => {\r\n    let { lumbers } = this.state\r\n    let calcLumber\r\n    if (e.target.name === 'quantity') {\r\n      calcLumber = this.calcRowQuantity(lumber, e.target.value)\r\n    }\r\n    if (e.target.name === 'rate') {\r\n      calcLumber = this.calcRowRate(lumber, e.target.value)\r\n    }\r\n\r\n    lumbers = replaceItemInDictArrayById(lumbers, calcLumber)\r\n\r\n    let totalVolume = this.calcTotalVolume(lumbers)\r\n\r\n    let totalCash = this.calcTotalCash(lumbers)\r\n    \r\n    this.setState({ \r\n        ...this.state,\r\n        lumbers: lumbers,\r\n        totalVolume: totalVolume,\r\n        totalCash: totalCash,\r\n        message: null\r\n        })\r\n  }\r\n\r\n  addEmployee = (employee) => {\r\n    let { activeEmployees } = this.state\r\n    activeEmployees = toggleArrayDictById(activeEmployees, employee)\r\n    this.setState({\r\n      ...this.state,\r\n      activeEmployees: activeEmployees\r\n    })\r\n  }\r\n\r\n  preSave = () => {\r\n    const { lumbers, totalCash, totalVolume, activeEmployees  } = this.state\r\n\r\n    let eIds = []\r\n    activeEmployees.map(emp => eIds = lodashToggle(eIds, emp.id))\r\n\r\n    let raw_records = []\r\n    lumbers.map(lumber =>{\r\n      if (lumber.cash > 0 && lumber.quantity > 0) {\r\n        raw_records = lodashToggle(raw_records, lumber)\r\n      }\r\n    })\r\n    let data = {\r\n      shift_type: 'day',\r\n      date: null,\r\n      raw_records: raw_records,\r\n      employees: eIds,\r\n      employee_cash: totalCash,\r\n      volume: totalVolume,\r\n      employeesData: activeEmployees,\r\n      cash_per_employee: totalCash / eIds.length\r\n    }\r\n\r\n    this.setState({\r\n      ...this.state,\r\n      dataToSave: data,\r\n    })\r\n  }\r\n\r\n  saveData = () => {\r\n    const { dataToSave} = this.state\r\n    const token = localStorage.getItem('token');\r\n    axios({\r\n      method: 'post',\r\n      url: endpoints.MANAGER_SHIFT_CREATE,\r\n      data: dataToSave,\r\n      headers: { 'content-type': 'application/JSON', 'Authorization': `JWT ${token}` }\r\n    })\r\n    .then(response => {\r\n      this.setState({ message: 'Данные записаны.', createdShift: response.data });\r\n    })\r\n\r\n    this.setState({\r\n      ...this.state,\r\n      activeEmployees: [],\r\n      lumbers: this.state.initLumbers,\r\n      totalVolume: 0,\r\n      totalCash: 0,\r\n      note: '',\r\n      dataToSave: null,\r\n    })\r\n  }\r\n\r\n  back = () => {\r\n    this.setState({dataToSave: null})\r\n  }\r\n\r\n  switchCalc = (calcType) => {\r\n    this.setState({\r\n      lumbers: this.state.initLumbers,\r\n      totalCash: 0,\r\n      totalVolume: 0,\r\n      calcType: calcType,\r\n      activeEmployees: []\r\n    })\r\n  }\r\n\r\n  render() {\r\n    const { lumbers, totalVolume, totalCash, message, createdShift, dataToSave, calcType, \r\n      activeEmployees, employees}  = this.state\r\n    return (\r\n      <div>\r\n        {createdShift\r\n          ? <CreatedShift shift={createdShift} message={message}/>\r\n          : dataToSave\r\n            ? <ShiftToSave shift={dataToSave} saveData={this.saveData} back={this.back}/>\r\n            : <div>\r\n                <div className='card card-style mb-1 mt-2'>\r\n                  <div className='content'>\r\n                  <h2>Смена </h2>\r\n                    <div className='d-flex justify-content-between my-2'>\r\n                      <button className={calcType === 'mixed' ? 'btn btn-s bg-highlight' : 'btn btn-s border'}\r\n                        onClick={() => this.switchCalc('mixed')}\r\n                        >доска перемешку</button>\r\n                      <button className={calcType === 'sorted' ? 'btn btn-s bg-highlight' : 'btn btn-s border'} \r\n                        onClick={() => this.switchCalc('sorted')}>\r\n                        доска по сортам</button>\r\n                    </div>\r\n                    {lumbers.length > 0 &&\r\n                      <LumberTableMixed\r\n                        calcType={this.state.calcType}\r\n                        lumbers={lumbers}\r\n                        calcRowAndTotal={this.calcRowAndTotal}\r\n\r\n                        totalCash={totalCash}\r\n                        totalVolume={totalVolume}\r\n                      />\r\n                    }\r\n                  </div>\r\n                </div>\r\n                <div className='card card-style mb-3'>\r\n                  <EmployeesBlock \r\n                    totalCash={totalCash} \r\n                    employees={employees} \r\n                    activeEmployees={activeEmployees} \r\n                    addEmployee={this.addEmployee}/>\r\n\r\n                </div>\r\n                {(activeEmployees.length > 0 && totalCash > 0) > 0 &&\r\n                  <button   \r\n                      onClick={this.preSave}\r\n                      className='mt-4 btn btn-center-xl btn-xxl text-uppercase font-900 bg-highlight rounded-sm shadow-l'>\r\n                      Далее\r\n                    </button>\r\n                }\r\n              </div>          \r\n          }\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\n\r\nconst mapStateToProps = (state) => ({\r\n  isLoggedIn: state.auth.isLoggedIn,\r\n  user: state.auth.user,\r\n  shopToSee: state.auth.shopToSee,\r\n});\r\n\r\n\r\nconst mapDispatchToProps = dispatch => ({  \r\n})\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ShiftCreateComponent);","import React, { useState, useRef  } from 'react';\r\n\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Select from '@material-ui/core/Select'\r\nimport InputLabel from '@material-ui/core/InputLabel'\r\nimport Checkbox from '@material-ui/core/Checkbox';\r\nimport FormControl from '@material-ui/core/FormControl'\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\r\n\r\nimport { getObjectbyId } from './utils';\r\n\r\n\r\nfunction LumberInputs (props) {\r\n  const { lumber, calcRowQnty, calcRowVolume, calcRowCash, setRamaPrice, label } = props\r\n  return (\r\n    <div className=''>\r\n      <h5>{label}:</h5>\r\n      <div className='d-flex justify-content-start '>\r\n        <TextField \r\n          className='pr-2'\r\n          id=\"outlined-margin-dense\" \r\n          variant=\"outlined\" \r\n          label='Количество'\r\n          type='number'\r\n          onChange={(e) => calcRowQnty(e, lumber.id)}\r\n          value={lumber.quantity > 0 && lumber.quantity}/>\r\n\r\n        <TextField \r\n          className='pr-2'\r\n          id=\"outlined-margin-dense\"\r\n          variant=\"outlined\" \r\n          label='Объем'\r\n          type='number'\r\n          onChange={(e) => calcRowVolume(e, lumber.id)}\r\n          value={lumber.volume_total > 0 && lumber.volume_total}/>\r\n      </div>\r\n      <div className='d-flex justify-content-start mt-2'>\r\n        <TextField \r\n          className='pr-2'\r\n          id=\"outlined-margin-dense\"\r\n          variant=\"outlined\" \r\n          label='Цена за 1м3'\r\n          type='number'\r\n          onChange={(e) => calcRowCash(e, lumber.id)}\r\n          value={lumber.selling_price > 0 && lumber.selling_price}/>\r\n        <TextField \r\n          className='pr-2'\r\n          id=\"outlined-margin-dense\"\r\n          variant=\"outlined\" \r\n          disabled\r\n          label='Сумма'\r\n          type='number'\r\n          value={lumber.selling_total_cash > 0 && lumber.selling_total_cash}/>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport function LumberOptGroup (props) {\r\n  const { woodSpecie, lumberType, pineBrus, pineDoska, larchBrus, larchDoska } = props\r\n  let lumberOptions = []\r\n  if (woodSpecie === 'pine' && lumberType === 'brus') lumberOptions = pineBrus\r\n  if (woodSpecie === 'pine' && lumberType === 'doska') lumberOptions = pineDoska\r\n  if (woodSpecie === 'larch' && lumberType === 'brus') lumberOptions = larchBrus\r\n  if (woodSpecie === 'larch' && lumberType === 'doska') lumberOptions = larchDoska\r\n  \r\n  return (\r\n    <optgroup label>\r\n      {lumberOptions.map(lumber =>\r\n        <option value={lumber.id} >{`${lumber.name} ${lumber.wood_species}`} </option>\r\n        )}\r\n    </optgroup>\r\n  )\r\n}\r\n\r\n\r\nexport function LumbersToSale (props) {\r\n  const { lumber, setLumberID, calcRowQnty, calcRowCash, pineBrus,  pineDoska, turnCalc, delLumber, larchBrus,\r\n     calcRoundRowQnty, calcRowVolume, calcRoundRowVolume, calcChinaRowQnty, calcChinaRowVolume, setRamaPrice,\r\n     stockType, larchDoska } = props\r\n\r\n  const lumberRef = useRef(null);\r\n  const executeScroll = () => lumberRef.current.scrollIntoView()\r\n\r\n  const woodSpecies = [['pine', 'сосна'], ['larch', 'лиственница']]\r\n  const [currentWoodSpecies, setCurrentWoodSpecies] = useState('pine');\r\n\r\n  const lumberTypes = [['brus', 'брус'], ['doska', 'доска']]\r\n  const [currentLumberType, setCurrentLumberType] = useState('brus');\r\n\r\n  const filterBtnClass = 'btn btn-m border w-100 mx-2'\r\n\r\n  return (\r\n    <div className='mt-2 mb-3 px-2 py-3 bg-white rounded-m border' ref={lumberRef}>\r\n      <InputLabel htmlFor=\"grouped-native-select\" className='text-center font-19 font-600 color-black'>\r\n        Пиломатериал {lumber.id + 1}\r\n      </InputLabel>\r\n\r\n      <div className='d-flex justify-content-around my-2'>\r\n        {woodSpecies.map(woodSpecie =>\r\n          <button className={woodSpecie[0] === currentWoodSpecies ? filterBtnClass + ' bg-green2-light' \r\n            : filterBtnClass} \r\n            onClick={() => setCurrentWoodSpecies(woodSpecie[0])}>\r\n            {woodSpecie[1]}\r\n          </button>\r\n        )}\r\n      </div>\r\n\r\n      <div className='d-flex justify-content-around mb-2'>\r\n        {lumberTypes.map(lumberType =>\r\n          <button className={lumberType[0] === currentLumberType ? filterBtnClass + ' bg-yellow1-light' \r\n            : filterBtnClass} \r\n            onClick={() => setCurrentLumberType(lumberType[0])}>\r\n            {lumberType[1]}\r\n          </button>\r\n        )}\r\n      </div>\r\n\r\n      <Select \r\n        native \r\n        defaultValue=\"\" \r\n        id=\"grouped-native-select\" \r\n        className='color-dark1-light'\r\n        fullWidth\r\n        value={lumber.lumber} onChange={(e) =>setLumberID(e, lumber.id)}\r\n        name='lumber'\r\n        data-id={lumber.id}\r\n        onClick={executeScroll}\r\n        >\r\n        <option aria-label=\"None\" />\r\n        <LumberOptGroup woodSpecie={currentWoodSpecies} lumberType={currentLumberType}\r\n          pineBrus={pineBrus} pineDoska={pineDoska} larchBrus={larchBrus} larchDoska={larchDoska} />\r\n      </Select>\r\n\r\n      {lumber.lumber > 0 && \r\n        <div className='mt-2'>\r\n          <div className='d-flex justify-content-around'>\r\n            <button className={lumber.calc_type === 'exact' ? 'btn btn-m bg-blue1-light' \r\n              : 'btn btn-m border'} \r\n              onClick={() => turnCalc(lumber.id, 'exact')}>\r\n              счет Т\r\n            </button>\r\n            <button className={lumber.calc_type === 'round' ? 'btn btn-m bg-blue1-light' \r\n              : 'btn btn-m border'}\r\n              onClick={() => turnCalc(lumber.id, 'round')}>\r\n              счет О\r\n            </button>\r\n            {lumber.china_volume > 0 &&\r\n              <button className={lumber.calc_type === 'china' ? 'btn btn-m bg-blue1-light' \r\n              : 'btn btn-m border'}\r\n              onClick={() => turnCalc(lumber.id, 'china')}>\r\n                Китайский счет\r\n            </button>\r\n            }\r\n          </div>\r\n          {lumber.calc_type === 'exact' &&\r\n            <LumberInputs \r\n              lumber={lumber}\r\n              label={'Счет Т'} \r\n              calcRowQnty={calcRowQnty} \r\n              calcRowVolume={calcRowVolume}\r\n              calcRowCash={calcRowCash}\r\n              setRamaPrice={setRamaPrice}\r\n            />\r\n          }\r\n          {lumber.calc_type === 'round' &&\r\n            <LumberInputs \r\n              lumber={lumber}\r\n              label={'Счет О'} \r\n              calcRowQnty={calcRoundRowQnty} \r\n              calcRowVolume={calcRoundRowVolume}\r\n              calcRowCash={calcRowCash}\r\n              setRamaPrice={setRamaPrice}\r\n            />            \r\n          }\r\n          {lumber.calc_type === 'china' &&\r\n            <LumberInputs \r\n              lumber={lumber}\r\n              label={'Китайский счет'} \r\n              calcRowQnty={calcChinaRowQnty} \r\n              calcRowVolume={calcChinaRowVolume}\r\n              calcRowCash={calcRowCash}\r\n              setRamaPrice={setRamaPrice}\r\n            />            \r\n          }\r\n        </div>}\r\n      {lumber.lumber > 0 && \r\n        <button className='btn btn-sm bg-red2-light mt-2 ' onClick={() => delLumber(lumber.id)}>удалить</button>\r\n      }\r\n    </div>\r\n  )\r\n}\r\n\r\nexport function SaleCheckList (props) {\r\n  const { setAddParams, seller, sellers, client, delivery_fee, preSave } = props\r\n\r\n  return (\r\n    <div>\r\n      <div className='d-flex justify-content-between mb-1 '>\r\n        <TextField \r\n          className='pr-2 pt-2'\r\n          variant=\"standard\" \r\n          label='Имя клиента'\r\n          type='text'\r\n          name='client'\r\n          onChange={setAddParams}\r\n          value={client && client}/>\r\n        <FormControl  className='pb-4'>\r\n          <InputLabel >Продавец</InputLabel>\r\n          <Select \r\n            native \r\n            defaultValue=\"\" \r\n            className='color-dark1-light'\r\n            value={seller} \r\n            onChange={setAddParams}\r\n            name='seller'\r\n            >\r\n            <option aria-label=\"None\" />\r\n            {sellers && sellers.length > 0 && sellers.map(s => \r\n              <option value={s.id} >{s.nickname} </option>\r\n            )}\r\n          </Select>\r\n        </FormControl>\r\n      </div>\r\n      <div className='d-flex justify-content-between mb-1 '>\r\n        <TextField \r\n            className='pr-2'\r\n            id=\"outlined-margin-dense\"\r\n            variant=\"outlined\" \r\n            label='Доставка'\r\n            type='number'\r\n            name='delivery_fee'\r\n            onChange={setAddParams}\r\n            value={delivery_fee > 0 && delivery_fee}/>\r\n      </div>\r\n      <button\r\n        onClick={preSave}\r\n        className='btn btn-center-xl btn-xxl text-uppercase font-900 bg-highlight rounded-sm \r\n          shadow-l mt-4'>\r\n        Далее\r\n      </button>\r\n    </div>\r\n    )\r\n}\r\n\r\nfunction LumbersTable (props) {\r\n  const { lumber_records } = props\r\n  return (\r\n    <table className='table table-sm table-responsive mt-2'>\r\n      <thead>\r\n        <th>\r\n          Пиломат\r\n        </th>\r\n        <th>\r\n          кол-во\r\n        </th>\r\n        <th>\r\n          объем\r\n        </th>\r\n        <th>\r\n          цена за 1м3\r\n        </th>\r\n        <th>\r\n          сумма продажи\r\n        </th>\r\n      </thead>\r\n      <tbody>\r\n        {lumber_records.map(lumber_record =>\r\n        <tr>\r\n          <td>{lumber_record.name}</td>\r\n          <td>{lumber_record.quantity} шт</td>\r\n          <td>{lumber_record.volume_total} м3</td>\r\n          <td>{lumber_record.selling_price} руб</td>\r\n          <td>{lumber_record.selling_total_cash} руб</td>\r\n        </tr>\r\n          )}\r\n      </tbody>\r\n    </table>\r\n  )\r\n}\r\n\r\nexport function CreatedSale (props) {\r\n  const { sale, message } = props\r\n  const rowClass = 'mb-1 font-15 font-400 color-black'\r\n  return (\r\n    <div className='card card-style mt-2'>\r\n      <div className='content'>\r\n        <h4>Запись сохранена</h4>\r\n        {sale &&\r\n          <div className=''>            \r\n            <p className={rowClass}>Дата: {sale.date}</p>\r\n            <p className={rowClass}>Клиент: {sale.client}</p>\r\n            <p className={rowClass}>Объем: {sale.volume.toFixed(4)} м3</p>\r\n            <p className={rowClass}>Вознаграждение продавца: {sale.seller_fee} рублей</p>\r\n            {/* <p className={rowClass}>Вознаграждение грузчика: {sale.loader_fee} рублей</p> */}\r\n            <p className={rowClass}>Стоимость доставки: {sale.delivery_fee} рублей</p>\r\n\r\n            <p className='mb-1 font-17 font-500 color-black'>\r\n              Сумма продажи: {sale.selling_total_cash.toFixed(1)}  рублей\r\n            </p>\r\n\r\n            <LumbersTable lumber_records={sale.lumber_records}/>\r\n          </div>\r\n        }\r\n        {message &&\r\n          <h2 className='color-green1-light text-center'>Данные сохранены!</h2> \r\n        }\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport function SaleCommonToCreate (props) {\r\n  const { sale, saveData, back, sellers } = props\r\n  const rowClass = 'mb-1 font-15 font-400 color-black'\r\n  let seller = null\r\n  if (sellers)\r\n    seller = getObjectbyId(sellers, sale.seller)\r\n  return (\r\n    <div className='card card-style mt-2'>\r\n      <div className='content'>\r\n        <h4>Проверяем данные</h4>\r\n        {sale &&\r\n          <div className=''>\r\n            <p className={rowClass}>Клиент: {sale.client}</p>\r\n            <p className={rowClass}>Объем: {sale.volume.toFixed(4)} м3</p>\r\n            <p className={rowClass}>Грузчик: {sale.loader ? 'да' : \"нет\"} </p>\r\n            {/* <p className={rowClass}>Бонус складу: {sale.bonus_kladman ? 'да' : 'нет'}</p> */}\r\n            <p className={rowClass}>Продавец: {seller ? seller.nickname : 'нет'}</p>\r\n            <p className={rowClass}>Доставка: {sale.deliveryFee ? sale.deliveryFee + 'рублей' : 'нет'}</p>\r\n            <p className='mb-1 font-17 font-500 color-black'>Сумма: {sale.sale_cash.toFixed(1)} рублей</p>\r\n            <LumbersTable lumber_records={sale.raw_records}/>\r\n          </div>\r\n        }\r\n        <div className='d-flex justify-content-around'>\r\n          <button onClick={back}\r\n            className='btn btn-s mr-2 text-uppercase font-900 bg-dark color-white rounded-sm shadow-l'>\r\n            назад\r\n          </button>\r\n          <button onClick={saveData}\r\n            className='btn btn-s text-uppercase font-900 bg-highlight rounded-sm shadow-l mt-2'>\r\n              Рассчитать и сохранить данные\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}","import axios from 'axios';\r\n\r\nimport React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\n\r\nimport endpoints from '../../redux/api/endpoints';\r\nimport { createUrlParamsFromFilters } from '../../redux/api/utils';\r\nimport { replaceItemInDictArrayById, getObjectbyId, toggleArrayDictById, lodashToggle } \r\n  from '../../components/utils';\r\n\r\nimport { LumbersToSale, SaleCheckList, SaleCommonToCreate, CreatedSale } \r\n  from '../../components/SaleCommon';\r\n\r\n\r\nexport class SaleCreateCommonContainer extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      pineBrus: [],\r\n      larchBrus: [],\r\n      pineDoska: [],\r\n      larchDoska: [],\r\n      lumbers: [],\r\n\r\n      sellers: [],\r\n      seller: null,\r\n      bonus_kladman: null,\r\n      bonus_kladman_label: false,\r\n      loader: false,\r\n      client: '',\r\n      china_vira: 0,\r\n      delivery_fee: 0,\r\n\r\n      lumbersToSale: [],\r\n\r\n      createdSale: null,\r\n      dataToSave: null,\r\n\r\n      message: null,\r\n      error: null,\r\n\r\n      totalCash: 0,\r\n      totalVolume: 0\r\n      \r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    const token = localStorage.getItem('token');\r\n    const params = createUrlParamsFromFilters({stock_type: this.props.user.shop_type});\r\n    \r\n    axios({\r\n      method: 'get',\r\n      url: endpoints.MANAGER_SALE_INIT_DATA,\r\n      headers: { 'Authorization': `JWT ${token}` },\r\n      params: params\r\n    })\r\n    .then(res => {\r\n      const initData = res.data;\r\n      this.setState({ \r\n        pineBrus: initData.pine_brus_lumbers,\r\n        larchBrus: initData.larch_brus_lumbers,\r\n        pineDoska: initData.pine_doska_lumbers,\r\n        larchDoska: initData.larch_doska_lumbers,\r\n        lumbers: initData.lumbers,\r\n        sellers: initData.sellers,\r\n        bonus_kladman: initData.kladman_id\r\n        });\r\n    })\r\n  }\r\n\r\n  addLumberToSale = () => {\r\n    this.setState({\r\n      ...this.state,\r\n      lumbersToSale: [\r\n        ...this.state.lumbersToSale,\r\n        {id: this.state.lumbersToSale.length}\r\n      ]\r\n    })\r\n  }\r\n\r\n  setLumberID = (e, id) => {\r\n    let { lumbersToSale, lumbers } = this.state\r\n    let lumberData = getObjectbyId(lumbers, e.target.value)\r\n    lumberData = { ...lumberData, id: id, }\r\n    \r\n    lumbersToSale = replaceItemInDictArrayById(lumbersToSale, lumberData)\r\n    \r\n    this.setState({\r\n      lumbersToSale: lumbersToSale\r\n    })\r\n  }\r\n\r\n  calcRowQnty = (e, id) => {\r\n    let { lumbersToSale } = this.state\r\n    let lumber = getObjectbyId(lumbersToSale, id)\r\n    lumber.quantity =  e.target.value ? parseInt(e.target.value) : 0\r\n    lumber.volume_total = (lumber.volume * lumber.quantity).toFixed(4)\r\n    lumber.selling_total_cash = (lumber.volume_total * lumber.selling_price).toFixed(0)\r\n\r\n    lumbersToSale = replaceItemInDictArrayById(lumbersToSale, lumber)\r\n    const { totalCash, totalVolume } = this.calcTotal(lumbersToSale)\r\n    \r\n    this.setState({\r\n      lumbersToSale: lumbersToSale,\r\n      totalCash: totalCash,\r\n      totalVolume: totalVolume\r\n    })\r\n  }\r\n\r\n  calcRowVolume = (e, id) => {\r\n    let { lumbersToSale } = this.state\r\n    let lumber = getObjectbyId(lumbersToSale, id)\r\n    lumber.volume_total =  e.target.value ? parseFloat(e.target.value) : 0\r\n    lumber.quantity = (lumber.volume_total / lumber.volume).toFixed(4)\r\n    lumber.selling_total_cash = (lumber.volume_total * lumber.selling_price).toFixed(0)\r\n\r\n    lumbersToSale = replaceItemInDictArrayById(lumbersToSale, lumber)\r\n    const { totalCash, totalVolume } = this.calcTotal(lumbersToSale)\r\n    \r\n    this.setState({\r\n      lumbersToSale: lumbersToSale,\r\n      totalCash: totalCash,\r\n      totalVolume: totalVolume\r\n    })\r\n  }\r\n\r\n  calcRowCash = (e, id) => {\r\n    let { lumbersToSale } = this.state\r\n    let lumber = getObjectbyId(lumbersToSale, id)\r\n    lumber.selling_price =  e.target.value ? parseInt(e.target.value) : 0\r\n    lumber.selling_total_cash = (lumber.volume_total * lumber.selling_price).toFixed(0)\r\n\r\n    lumbersToSale = replaceItemInDictArrayById(lumbersToSale, lumber)\r\n    const { totalCash, totalVolume } = this.calcTotal(lumbersToSale)\r\n\r\n    this.setState({\r\n      lumbersToSale: lumbersToSale,\r\n      totalCash: totalCash,\r\n      totalVolume: totalVolume\r\n    })\r\n  }\r\n\r\n  calcRoundRowQnty = (e, id) => {\r\n    let { lumbersToSale } = this.state\r\n    let lumber = getObjectbyId(lumbersToSale, id)\r\n    lumber.quantity =  e.target.value ? parseInt(e.target.value) : 0\r\n    lumber.volume_total = (lumber.round_volume * lumber.quantity).toFixed(4)\r\n    lumber.selling_total_cash = (lumber.volume_total * lumber.selling_price).toFixed(0)\r\n\r\n    lumbersToSale = replaceItemInDictArrayById(lumbersToSale, lumber)\r\n    const { totalCash, totalVolume } = this.calcTotal(lumbersToSale)\r\n    \r\n    this.setState({\r\n      lumbersToSale: lumbersToSale,\r\n      totalCash: totalCash,\r\n      totalVolume: totalVolume\r\n    })\r\n  }\r\n\r\n  calcRoundRowVolume = (e, id) => {\r\n    let { lumbersToSale } = this.state\r\n    let lumber = getObjectbyId(lumbersToSale, id)\r\n    lumber.volume_total =  e.target.value ? parseFloat(e.target.value) : 0\r\n    lumber.quantity = (lumber.volume_total / lumber.round_volume).toFixed(0)\r\n    lumber.selling_total_cash = (lumber.volume_total * lumber.selling_price).toFixed(0)\r\n\r\n    lumbersToSale = replaceItemInDictArrayById(lumbersToSale, lumber)\r\n    const { totalCash, totalVolume } = this.calcTotal(lumbersToSale)\r\n    \r\n    this.setState({\r\n      lumbersToSale: lumbersToSale,\r\n      totalCash: totalCash,\r\n      totalVolume: totalVolume\r\n    })\r\n  }\r\n\r\n  calcChinaRowQnty = (e, id) => {\r\n    let { lumbersToSale } = this.state\r\n    let lumber = getObjectbyId(lumbersToSale, id)\r\n    lumber.quantity =  e.target.value ? parseInt(e.target.value) : 0\r\n    lumber.volume_total = (lumber.china_volume * lumber.quantity).toFixed(4)\r\n    lumber.selling_total_cash = (lumber.volume_total * lumber.selling_price).toFixed(0)\r\n\r\n    lumbersToSale = replaceItemInDictArrayById(lumbersToSale, lumber)\r\n    const { totalCash, totalVolume } = this.calcTotal(lumbersToSale)\r\n    \r\n    this.setState({\r\n      lumbersToSale: lumbersToSale,\r\n      totalCash: totalCash,\r\n      totalVolume: totalVolume\r\n    })\r\n  }\r\n\r\n  calcChinaRowVolume = (e, id) => {\r\n    let { lumbersToSale } = this.state\r\n    let lumber = getObjectbyId(lumbersToSale, id)\r\n    lumber.volume_total =  e.target.value ? parseFloat(e.target.value) : 0\r\n    lumber.quantity = (lumber.volume_total / lumber.china_volume).toFixed(0)\r\n    lumber.selling_total_cash = (lumber.volume_total * lumber.selling_price).toFixed(0)\r\n\r\n    lumbersToSale = replaceItemInDictArrayById(lumbersToSale, lumber)\r\n    const { totalCash, totalVolume } = this.calcTotal(lumbersToSale)\r\n    \r\n    this.setState({\r\n      lumbersToSale: lumbersToSale,\r\n      totalCash: totalCash,\r\n      totalVolume: totalVolume\r\n    })\r\n  }\r\n\r\n  setShopPrice = (e, id) => {\r\n    let { lumbersToSale } = this.state\r\n    let lumber = getObjectbyId(lumbersToSale, id)\r\n    lumber.shop_price =  e.target.value ? parseFloat(e.target.value) : 0\r\n    lumbersToSale = replaceItemInDictArrayById(lumbersToSale, lumber)\r\n    \r\n    this.setState({\r\n      lumbersToSale: lumbersToSale,\r\n    })\r\n  }\r\n\r\n  turnCalc = (id, calcType) => {\r\n    let { lumbersToSale } = this.state\r\n    let lumber = getObjectbyId(lumbersToSale, id)\r\n\r\n    if (calcType === 'round') {\r\n      lumber.volume_total = (lumber.quantity * lumber.round_volume).toFixed(3)\r\n    } \r\n\r\n    if (calcType === 'exact') {\r\n      lumber.volume_total = (lumber.quantity * lumber.volume).toFixed(4)\r\n    }\r\n\r\n    if (calcType === 'china') {\r\n      lumber.volume_total = (lumber.quantity * lumber.china_volume).toFixed(4)\r\n      lumber.selling_price = 0\r\n    }\r\n\r\n    lumber.calc_type = calcType\r\n    lumber.selling_total_cash = (lumber.volume_total * lumber.selling_price).toFixed(0)\r\n\r\n    lumbersToSale = replaceItemInDictArrayById(lumbersToSale, lumber)\r\n    const { totalCash, totalVolume } = this.calcTotal(lumbersToSale)\r\n\r\n    this.setState({\r\n      lumbersToSale: lumbersToSale,\r\n      totalCash: totalCash,\r\n      totalVolume: totalVolume\r\n    })\r\n  }\r\n\r\n  calcTotal = (lumbers) => {\r\n    let totalCash = 0\r\n    let totalVolume = 0.0\r\n\r\n    lumbers.map(lumber => {\r\n      totalCash += parseInt(lumber.selling_total_cash)\r\n      totalVolume += parseFloat(lumber.volume_total)\r\n    })\r\n    return { totalCash: totalCash.toFixed(0), totalVolume: totalVolume.toFixed(4) }\r\n  }\r\n\r\n  delLumber = (id) => {\r\n    let { lumbersToSale } = this.state\r\n    let lumber = getObjectbyId(lumbersToSale, id)\r\n    lumbersToSale = toggleArrayDictById(lumbersToSale, lumber)\r\n    const { totalCash, totalVolume } = this.calcTotal(lumbersToSale)\r\n\r\n    this.setState({\r\n      lumbersToSale: lumbersToSale,\r\n      totalCash: totalCash,\r\n      totalVolume: totalVolume\r\n    })\r\n  }\r\n\r\n  setAddParams = (e) => {\r\n    if (e.target.name === 'loader' || e.target.name === 'bonus_kladman_label')\r\n      this.setState({[e.target.name]: !this.state[e.target.name]})\r\n    else\r\n      this.setState({[e.target.name]: e.target.value})\r\n  }\r\n\r\n  setChinaVira = (e) => {\r\n    let { lumbersToSale } = this.state\r\n    let { totalCash } = this.calcTotal(lumbersToSale)\r\n    let china_vira = parseInt(e.target.value)\r\n    if (china_vira > 0)\r\n      totalCash -= china_vira\r\n    \r\n    this.setState({\r\n      totalCash: totalCash,\r\n      china_vira: china_vira\r\n    })\r\n  }\r\n\r\n  preSave = () => {\r\n    const { lumbersToSale, loader, seller, bonus_kladman_label, bonus_kladman,\r\n      delivery_fee, totalCash, totalVolume, client, china_vira } = this.state\r\n    let raw_records = []\r\n    lumbersToSale.map(lumber =>{\r\n      if (lumber.selling_total_cash > 0 && lumber.quantity > 0) {\r\n        raw_records = lodashToggle(raw_records, lumber)\r\n      }\r\n    })\r\n\r\n    let data = {\r\n      raw_records: raw_records,\r\n      date: null,\r\n      loader: loader,\r\n      seller: seller,\r\n      bonus_kladman: bonus_kladman_label ? bonus_kladman : null,\r\n      client: client,\r\n      delivery_fee: delivery_fee,\r\n\r\n      sale_cash: parseFloat(totalCash),\r\n      volume: parseFloat(totalVolume),\r\n      china_vira: china_vira\r\n    }\r\n    this.setState({\r\n      dataToSave: data,\r\n    })\r\n  }\r\n\r\n  saveData = () => {\r\n    const { dataToSave } = this.state\r\n    const token = localStorage.getItem('token');\r\n    \r\n    axios({\r\n      method: 'post',\r\n      url: endpoints.MANAGER_SALE_CREATE,\r\n      data: dataToSave,\r\n      headers: { 'content-type': 'application/JSON', 'Authorization': `JWT ${token}` }\r\n    })\r\n    .then(response => {\r\n      this.setState({ message: response.data.message, createdSale: response.data.sale });\r\n    })\r\n  }\r\n\r\n  back = () => {\r\n    this.setState({dataToSave: null})\r\n  }\r\n \r\n  render() {\r\n    const { lumbersToSale, totalVolume, totalCash, createdSale, dataToSave, message } = this.state\r\n    return (\r\n      <div className=''>\r\n        {createdSale \r\n          ? <CreatedSale sale={createdSale} message={message}/>\r\n          : dataToSave\r\n            ? <SaleCommonToCreate sale={dataToSave} saveData={this.saveData} back={this.back} \r\n              sellers={this.state.sellers}/>\r\n            : <div >\r\n                <div className='content'>\r\n                  <h3>Что продаем?</h3> \r\n                  {lumbersToSale.length > 0  && lumbersToSale.map(lumber => lumber &&\r\n                    <LumbersToSale\r\n                      stockType={this.props.user.shop_type}\r\n                      lumber={lumber} \r\n                      setLumberID={this.setLumberID} \r\n\r\n                      calcRowQnty={this.calcRowQnty}\r\n                      calcRowCash={this.calcRowCash}\r\n                      calcRowVolume={this.calcRowVolume}\r\n\r\n                      calcRoundRowQnty={this.calcRoundRowQnty}\r\n                      calcRoundRowVolume={this.calcRoundRowVolume}\r\n\r\n                      calcChinaRowQnty={this.calcChinaRowQnty}\r\n                      calcChinaRowVolume={this.calcChinaRowVolume}\r\n\r\n                      setShopPrice={this.setShopPrice}\r\n\r\n                      turnCalc={this.turnCalc}\r\n                      delLumber={this.delLumber}\r\n                      pineBrus={this.state.pineBrus}\r\n                      larchBrus={this.state.larchBrus}\r\n                      pineDoska={this.state.pineDoska}\r\n                      larchDoska={this.state.larchDoska}\r\n                    />\r\n                  )}\r\n                  <div className='d-flex justify-content-center'>\r\n                    <button className='mt-1 btn btn-l bg-highlight' onClick={this.addLumberToSale}>\r\n                      Добавить пиломатериал\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n                {totalCash > 0 &&\r\n                  <div className='card card-style mt-2'>\r\n                    <div className='content'>\r\n                      <div className='d-flex justify-content-between'>\r\n                        <p className='font-15 mb-0'>Объем: {totalVolume} м3</p>\r\n                        <p className='font-15 mb-0'>Итого: {totalCash} р</p>\r\n                      </div>          \r\n                      <SaleCheckList \r\n                        setAddParams={this.setAddParams} \r\n                        sellers={this.state.sellers}\r\n                        seller={this.state.seller}\r\n                        bonus_kladman_label={this.state.bonus_kladman_label}\r\n                        loader={this.state.loader}\r\n                        client={this.state.client}\r\n                        delivery_fee={this.state.delivery_fee}\r\n\r\n                        china_vira={this.state.china_vira}\r\n                        setChinaVira={this.setChinaVira}\r\n\r\n                        preSave={this.preSave}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                  }\r\n              </div>\r\n          }\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\n\r\nconst mapStateToProps = (state) => ({\r\n  isLoggedIn: state.auth.isLoggedIn,\r\n  user: state.auth.user,\r\n  state: state\r\n});\r\n\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n})\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(SaleCreateCommonContainer);","import axios from 'axios';\r\n\r\nimport React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\n\r\nimport endpoints from '../../redux/api/endpoints';\r\nimport { jsDateTimeToStrDate } from '../../components/utils';\r\nimport { createUrlParamsFromFilters } from '../../redux/api/utils';\r\nimport { DateFilter } from '../../components/CommonForms';\r\n\r\n\r\nexport function SalesTable (props) {\r\n  const { sales, totals, deleteSale, shop } = props\r\n\r\n  return (\r\n    <table className='table table-sm table-responsive'>\r\n      <thead>\r\n        <th>Дата/Клиент</th>\r\n        <th>Пиломат</th>\r\n        <th>Сумма/Объем</th>\r\n        <th style={{lineHeight: '13px'}}>\r\n        {shop.sale_type === 'seller_kladman_same' \r\n          ? 'Продавeц (комиссия кладмэна из вознаграждения продавца)'\r\n          : 'Продавeц'\r\n        }\r\n        </th>\r\n        {/* <th>грузчик</th>\r\n        <th>кладмэн</th> */}\r\n        <th>Доставка</th>\r\n        <th className='text-nowrap'>Удалить</th>\r\n      </thead>\r\n      <tbody>\r\n        {sales.map(sale => \r\n          <tr>\r\n            <td style={{lineHeight: '15px'}}>\r\n              {sale.date}\r\n              <span className='d-block'>{sale.note}</span>\r\n              <span className='font-13'>{sale.sale_type}</span>\r\n            </td>\r\n            <td className='text-nowrap'>\r\n              {sale.lumber_records.map(lumber =>\r\n                <span className='d-block mb-2' style={{lineHeight: '14px'}}>\r\n                  {lumber.quantity}шт {lumber.lumber}\r\n                  <span className='d-block font-italic'>{lumber.wood_species}</span>\r\n                  <span className='d-block font-italic'>розница общ <span className='font-500'>\r\n                    {lumber.selling_total_cash}</span></span>\r\n                  <span className='d-block font-italic'>розница 1м3 <span className='font-500'>\r\n                    {lumber.selling_price}</span></span>\r\n                  <span className='d-block font-italic'>опт общ <span className='font-500'>\r\n                    {lumber.shop_total_cash}</span></span>\r\n                  <span className='d-block font-italic'>опт 1м3 <span className='font-500'>\r\n                    {lumber.shop_price}</span></span>\r\n                </span>\r\n                )}\r\n            </td>\r\n            <td >\r\n              <span>{sale.selling_total_cash}р</span>\r\n              <span className='d-block'>{sale.volume} м3</span>\r\n            </td>\r\n            <td style={{lineHeight: '15px'}}>\r\n              {shop.sale_type === 'seller_kladman_same' \r\n                ? <span className='d-block'>\r\n                    <span className='d-block'>{sale.seller_fee - sale.kladman_fee}</span>\r\n                    {`(${sale.seller_fee}  - ${sale.kladman_fee})`}\r\n                  </span>\r\n                : <span className='d-block'>{sale.seller_fee}</span>\r\n              }\r\n              {sale.seller_name && <span className=''>{sale.seller_name}</span>}\r\n            </td>\r\n            {/* <td>\r\n              {sale.loader_fee}\r\n            </td>\r\n            <td>\r\n              {sale.kladman_fee}\r\n            </td> */}\r\n            <td>\r\n              {sale.delivery_fee}\r\n            </td>\r\n            <td>\r\n              <button className='btn btn-xs bg-red1-light' value={sale.id} onClick={deleteSale}>Удалить</button>\r\n            </td>\r\n          </tr>\r\n        )}\r\n        <tr className='font-500 font-16'>\r\n          <td>Итого</td>\r\n          <td>-</td>\r\n          <td>{totals.total_selling_cash}</td>\r\n          <td>\r\n            {shop.sale_type === 'seller_kladman_same' \r\n             ? <span>\r\n                  <span className='d-block'>{totals.total_seller_fee - totals.total_kladman_fee}</span>\r\n                  {`(${totals.total_seller_fee}  - ${totals.total_kladman_fee})`}\r\n               </span>\r\n             : totals.total_seller_fee\r\n            }\r\n          </td>\r\n\r\n          {/* <td>{totals.total_loader_fee}</td>\r\n          <td>{totals.total_kladman_fee}</td> */}\r\n          <td>{totals.total_delivery_fee}</td>\r\n          <td>{totals.total_add_expenses}</td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n  )\r\n}\r\n\r\n\r\nexport class SaleList extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      saleList: [],\r\n      totals: {},\r\n\r\n      startDate: '',\r\n      endDate: '',\r\n      \r\n      message: null,\r\n      error: null,\r\n    }\r\n\r\n    this.deleteSale = this.deleteSale.bind(this);\r\n    this.setData = this.setData.bind(this);\r\n    this.showResults = this.showResults.bind(this);\r\n  }\r\n\r\n  componentDidMount() {\r\n    const token = localStorage.getItem('token');\r\n    let today = new Date()\r\n    let yesterday = new Date()\r\n    let startDate = jsDateTimeToStrDate(yesterday)\r\n    let endDate = jsDateTimeToStrDate(today)\r\n    const params = createUrlParamsFromFilters({shop: this.props.shopToSee.id, \r\n      date_before: endDate, date_after:startDate});\r\n\r\n    axios({\r\n      method: 'get',\r\n      url: endpoints.SALES,\r\n      params: params,\r\n      headers: {'Authorization': `JWT ${token}` }\r\n    })\r\n    .then(response => {\r\n      this.setState({ ...this.state, saleList: response.data.sales, totals: response.data.totals,\r\n        startDate: startDate, endDate: endDate });\r\n    })\r\n  }\r\n\r\n  deleteSale (e) {\r\n    const token = localStorage.getItem('token');\r\n\r\n    axios({\r\n      method: 'delete',\r\n      url: endpoints.manager_delete_sale(e.target.value),\r\n      headers: {'Authorization': `JWT ${token}` }\r\n    })\r\n    .then(response => {\r\n      this.setState({ ...this.state, saleList: response.data.sales, totals: response.data.totals });\r\n    })\r\n  }\r\n\r\n  setData (e) {\r\n    this.setState({\r\n      [e.target.name]: e.target.value \r\n    })\r\n  }\r\n\r\n  showResults () {\r\n    const token = localStorage.getItem('token');\r\n    const params = createUrlParamsFromFilters({shop: this.props.shopToSee.id, \r\n      date_before: this.state.endDate, date_after: this.state.startDate});\r\n    axios({\r\n      method: 'get',\r\n      url: endpoints.SALES,\r\n      headers: {'Authorization': `JWT ${token}` },\r\n      params: params\r\n    })\r\n    .then(response => {\r\n      this.setState({ ...this.state, saleList: response.data.sales, totals: response.data.totals });\r\n    })\r\n  }\r\n\r\n  render() {\r\n    const { saleList, totals } = this.state\r\n    return (\r\n      <div className='mt-2'>\r\n        <div className='card card-style mt-2'>\r\n          <div className='content'>\r\n            <DateFilter startDate={this.state.startDate} endDate={this.state.endDate} setData={this.setData}\r\n              showResults={this.showResults}/>\r\n          </div>\r\n        </div>\r\n        <div className='card card-style mb-2'>\r\n          <div className='content'>\r\n            <h4 className='mb-2'>Продажи ({saleList.length})</h4>\r\n            {saleList.length > 0 \r\n              ? <SalesTable sales={saleList} totals={totals} deleteSale={this.deleteSale}\r\n                  shop={this.props.shopToSee} />\r\n              : <h5>Нет продаж</h5>\r\n            }\r\n          </div>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\n\r\nconst mapStateToProps = (state) => ({\r\n  isLoggedIn: state.auth.isLoggedIn,\r\n  user: state.auth.user,\r\n  shopToSee: state.auth.shopToSee,\r\n  state: state\r\n});\r\n\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n})\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(SaleList);","import React, { } from 'react';\r\n\r\nexport function SalesList (props) {\r\n  const { sales, sales_totals, sellers_fee } = props\r\n\r\n  return (\r\n    <div>\r\n      <table className='table table-sm' style={{lineHeight: '17px'}}>\r\n        <thead>\r\n          <th>Сумма</th>\r\n          <th>Продавец</th>\r\n          {/* <th>Клад/груз</th> */}\r\n          <th>Доставка</th>\r\n        </thead>\r\n        <tbody>\r\n          {sales.length > 0 && sales.map(sale =>\r\n          <tr>\r\n            <td>\r\n              <span className='d-block'>{sale.client}</span>\r\n              <span>{sale.selling_total_cash}</span>\r\n            </td>\r\n            <td>\r\n              <span className='d-block'>{sale.seller_name}</span>\r\n              <span>{sale.seller_fee}</span>\r\n            </td>\r\n            {/* <td>\r\n              <span className='d-block'>К {sale.kladman_fee}</span>\r\n              <span>Г {sale.loader_fee}</span>\r\n            </td> */}\r\n            <td>\r\n              <span>{sale.delivery_fee}</span>\r\n            </td>\r\n          </tr>\r\n            )}\r\n          {sales_totals && \r\n            <tr>\r\n              <td className=''>\r\n                <span className='d-block font-15 '>Итого доход</span>\r\n                <span className='font-15 font-500 color-green2-light'>\r\n                  +{sales_totals.total_selling_cash} р\r\n                </span>\r\n              </td>\r\n              <td>\r\n                {sellers_fee.length > 0 && sellers_fee.map(seller => seller.total > 0 &&\r\n                  <span className='d-block'>{seller.name} {seller.total}</span>\r\n                )}\r\n              </td>\r\n              {/* <td>\r\n                <span className='d-block'>К {sales_totals.total_kladman_fee}</span>\r\n                <span>Г {sales_totals.total_loader_fee}</span>\r\n              </td> */}\r\n              <td>\r\n                <span>{sales_totals.total_delivery_fee}</span>\r\n              </td>\r\n            </tr>\r\n          }\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\nexport function CashRecordsList (props) {\r\n  const { records } = props\r\n\r\n  return (\r\n    <div>\r\n      <table className='table table-sm'>\r\n        <thead>\r\n          <th>Сумма</th>\r\n          <th>Примечание</th>\r\n        </thead>\r\n        <tbody>\r\n          {records.length > 0 && records.map(record =>\r\n          <tr>\r\n            {record.record_type == 'withdraw_employee' &&\r\n              <td className='text-nowrap color-red1-light'>\r\n                -{record.amount} р\r\n              </td>\r\n            }\r\n            {record.record_type == 'shop_expenses' &&\r\n              <td className='text-nowrap color-red1-light'>\r\n                -{record.amount} р\r\n              </td>\r\n            }\r\n            {record.record_type == 'sale_income' &&\r\n              <td className='text-nowrap color-green1-light'>\r\n                +{record.amount} р\r\n              </td>\r\n            }\r\n            <td className='text-nowrap'>\r\n              {record.note}\r\n            </td>\r\n          </tr>\r\n            )}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  )\r\n}\r\n","import axios from 'axios';\r\n\r\nimport React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\n\r\nimport endpoints from '../../redux/api/endpoints';\r\nimport { getToday } from '../../components/utils';\r\nimport { createUrlParamsFromFilters } from '../../redux/api/utils';\r\n\r\nimport { CashRecordsList, SalesList } from '../../components/DailyRep';\r\nimport { DayFilter } from '../../components/CommonForms';\r\n\r\n\r\nexport class DailyRepContainer extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      createdExpense: null,\r\n      expenses: [],\r\n\r\n      incomes: [],\r\n\r\n      sales: [],\r\n      sellers_fee: [],\r\n\r\n      allRecords: [],\r\n      total: null,\r\n      total_expenses: null,\r\n      total_incomes: null,\r\n\r\n      date: ''\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    const token = localStorage.getItem('token');\r\n    const params = createUrlParamsFromFilters({date: getToday(), shop: this.props.shopToSee.id});\r\n    \r\n    axios({\r\n      method: 'get',\r\n      url: endpoints.DAILY_REP,\r\n      params: params,\r\n      headers: { 'Authorization': `JWT ${token}` }\r\n    })\r\n    .then(res => {\r\n      const initData = res.data;\r\n      this.setState({ \r\n        expenses: initData.expense_records,\r\n        total_expenses: initData.expense_records_total,\r\n        incomes: initData.income_records,\r\n        total_incomes: initData.income_records_total,\r\n        allRecords: initData.records,\r\n        total: initData.records_total,\r\n        sales: initData.sales,\r\n        sales_totals: initData.sales_totals,\r\n        sellers_fee: initData.sales_sellers_fee,\r\n        date: getToday()\r\n        });\r\n    })\r\n  }\r\n\r\n  createExpense = (expense) => {\r\n    const token = localStorage.getItem('token');\r\n    \r\n    axios({\r\n      method: 'post',\r\n      url: endpoints.KLADMAN_EXPENSE_CREATE,\r\n      data: expense,\r\n      headers: { 'content-type': 'application/JSON', 'Authorization': `JWT ${token}` }\r\n    })\r\n    .then(response => {\r\n      this.setState({ message: response.data.message, createdExpense: response.data.expense,\r\n        allRecords: response.data.records, total: response.data.total, });\r\n    })\r\n  }\r\n\r\n  setData = (e) => {\r\n    this.setState({\r\n      [e.target.name]: e.target.value \r\n    })\r\n  }\r\n\r\n  showResults = () => {\r\n    const token = localStorage.getItem('token');\r\n    const params = createUrlParamsFromFilters({shop: this.props.shopToSee.id, date: this.state.date});\r\n    axios({\r\n      method: 'get',\r\n      url: endpoints.DAILY_REP,\r\n      headers: {'Authorization': `JWT ${token}` },\r\n      params: params\r\n    })\r\n    .then(res => {\r\n      const initData = res.data;\r\n      this.setState({ \r\n        expenses: initData.expense_records,\r\n        total_expenses: initData.expense_records_total,\r\n        incomes: initData.income_records,\r\n        total_incomes: initData.income_records_total,\r\n        allRecords: initData.records,\r\n        total: initData.records_total,\r\n        sales: initData.sales,\r\n        sales_totals: initData.sales_totals,\r\n        sellers_fee: initData.sales_sellers_fee\r\n        });\r\n    })\r\n  }\r\n\r\n  render() {\r\n    const { expenses, total_expenses, sales, sales_totals } = this.state\r\n    return (\r\n      <div className='card card-style mt-2 mb-0'>\r\n        <div className='content mb-0 '>\r\n          <h3 className=''>Дневной отчет</h3>\r\n        </div>\r\n        <div className='content mt-0'>\r\n          <DayFilter date={this.state.date} setData={this.setData} showResults={this.showResults} />\r\n        </div>\r\n        <div className='content mb-0 mt-0'>\r\n          <h5 className=''>Продажи</h5>\r\n          <SalesList sales={sales} sales_totals={sales_totals} sellers_fee={this.state.sellers_fee}/>\r\n        </div>\r\n        <div className='content mt-0'>\r\n          <h5 className='mb-1'>Расходы за день</h5>\r\n          {total_expenses && \r\n            <p className='mb-1 font-15 color-black'>\r\n              Итого расход: \r\n              <span className='font-500 color-red1-light'> -{total_expenses}р</span>\r\n            </p> }\r\n          <CashRecordsList records={expenses}/>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\n\r\nconst mapStateToProps = (state) => ({\r\n  isLoggedIn: state.auth.isLoggedIn,\r\n  user: state.auth.user,\r\n  shopToSee: state.auth.shopToSee,\r\n  state: state\r\n});\r\n\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n})\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(DailyRepContainer);","import React, { Component, useState  } from 'react';\r\n\r\nimport TextField from '@material-ui/core/TextField';\r\n\r\nexport function ExpensesList (props) {\r\n  const { expenses, deleteExpense } = props\r\n\r\n  return (\r\n    <div>\r\n      <table className='table table-sm'>\r\n        <thead>\r\n          <th>Сумма</th>\r\n          <th>Примечание</th>\r\n        </thead>\r\n        <tbody>\r\n          {expenses.length > 0 && expenses.map(expense =>\r\n          <tr>\r\n            <td>\r\n              {expense.amount} руб\r\n            </td>\r\n            <td>\r\n              {expense.note}\r\n            </td>\r\n            \r\n            <td>\r\n              <button className='btn btn-s bg-red1-light' onClick={() => deleteExpense(expense.id)}>\r\n                Удалить\r\n              </button>\r\n            </td>\r\n            \r\n          </tr>\r\n            )}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport function CreateExpense (props) {\r\n  const [amount, setCount] = useState();\r\n  const [note, setNote] = useState('');\r\n\r\n  return (\r\n    <div className=''>\r\n      <TextField \r\n          className='mb-2'\r\n          id=\"outlined-margin-dense\" \r\n          variant=\"outlined\" \r\n          fullWidth\r\n          label='Сумма'\r\n          type='number'\r\n          onChange={(e) => setCount(e.target.value)}\r\n          value={amount}/>\r\n      <TextField \r\n          className='mb-2'\r\n          id=\"outlined-margin-dense\" \r\n          variant=\"outlined\" \r\n          fullWidth\r\n          label='Примечание'\r\n          type='text'\r\n          onChange={(e) => setNote(e.target.value)}\r\n          value={note}/>\r\n      <button className='btn btn-m bg-highlight mt-2' \r\n        onClick={() => props.createExpense({amount: amount, note: note})}>\r\n        Записать\r\n      </button>\r\n    </div>\r\n  )\r\n}","import axios from 'axios';\r\n\r\nimport React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\n\r\nimport endpoints from '../../redux/api/endpoints';\r\nimport { getToday } from '../../components/utils';\r\nimport { createUrlParamsFromFilters } from '../../redux/api/utils';\r\n\r\nimport { ExpensesList, CreateExpense } from '../../components/Expenses';\r\n\r\n\r\nexport class ExpensesContainer extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      createExpense: null,\r\n      expenses: [],\r\n      total: null,\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    const token = localStorage.getItem('token');\r\n    const params = createUrlParamsFromFilters({created_at_after: getToday()});\r\n    \r\n    axios({\r\n      method: 'get',\r\n      url: endpoints.MANAGER_CASH_RECORDS_LIST,\r\n      params: params,\r\n      headers: { 'Authorization': `JWT ${token}` }\r\n    })\r\n    .then(res => {\r\n      const initData = res.data;\r\n      this.setState({ \r\n        expenses: initData.records,\r\n        total: initData.total\r\n        });\r\n    })\r\n  }\r\n\r\n  createExpense = (expense) => {\r\n    const token = localStorage.getItem('token');\r\n    \r\n    axios({\r\n      method: 'post',\r\n      url: endpoints.MANAGER_CASH_RECORDS_CREATE,\r\n      data: expense,\r\n      headers: { 'content-type': 'application/JSON', 'Authorization': `JWT ${token}` }\r\n    })\r\n    .then(response => {\r\n      this.setState({ message: response.data.message, createdExpense: response.data.expense,\r\n        expenses: response.data.records, total: response.data.total });\r\n    })\r\n  }\r\n\r\n  deleteExpense = (id) => {\r\n    const token = localStorage.getItem('token');\r\n\r\n    axios({\r\n      method: 'delete',\r\n      url: endpoints.manager_delete_expense(id),\r\n      headers: {'Authorization': `JWT ${token}` }\r\n    })\r\n    .then(res => {\r\n      this.setState({ ...this.state, \r\n        expenses: res.data.records,\r\n        total: res.data.totals,\r\n        amount: 0 });\r\n    })\r\n  }\r\n\r\n  render() {\r\n    const { expenses, createdExpense, total } = this.state\r\n    return (\r\n      <div className='card card-style mt-2'>\r\n        <div className='content mb-0'>\r\n          <h3 className=''>Расходы</h3>\r\n        </div>\r\n        <div className='content mb-0'>\r\n          {createdExpense\r\n            ? <div>\r\n                <button className='btn btn-m bg-highlight' onClick={() => this.setState({createdExpense: null})}>\r\n                  Создать еще\r\n                </button>\r\n              </div>\r\n            : <CreateExpense createExpense={this.createExpense}/>\r\n          }\r\n        </div>\r\n        <div className='content'>\r\n          <h3 className='mb-1'>За день</h3>\r\n          {total && <h5 className='mb-1'>Итого: {total}р</h5> }\r\n          <ExpensesList expenses={expenses} user={this.props.user} deleteExpense={this.deleteExpense}/>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\n\r\nconst mapStateToProps = (state) => ({\r\n  isLoggedIn: state.auth.isLoggedIn,\r\n  user: state.auth.user,\r\n  shopToSee: state.auth.shopToSee,\r\n  state: state\r\n})\r\n\r\nconst mapDispatchToProps = (dispatch) => ({\r\n})\r\n\r\nexport default connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n)(ExpensesContainer);","import axios from 'axios';\r\n\r\nimport React, { Component, useState } from 'react';\r\n\r\nimport TextField from '@material-ui/core/TextField';\r\n\r\nimport endpoints from '../../redux/api/endpoints';\r\nimport { parseErrorData } from '../../redux/api/utils';\r\n\r\n\r\nexport function LastOperations (props){\r\n  const { lastOperations } = props\r\n  return (\r\n    <div className='card card-style mt-0'>\r\n      <div className='content'>\r\n        <h4>Последние операции</h4>\r\n        {lastOperations.length > 0 \r\n        ? <table className='table table-sm table-responsive' style={{lineHeight: '16px'}}>\r\n            <thead className=''>\r\n              <th>Дата</th>\r\n              <th>Тип</th>\r\n              <th>Поставщик</th>\r\n              <th>Сумма</th>\r\n            </thead>\r\n            <tbody>\r\n              {lastOperations.map(op => \r\n                <tr>\r\n                  <td className='text-nowrap'>{op.created_at}</td>\r\n                  <td>\r\n                    {op.record_type === 'withdraw_employee' \r\n                      ? 'Оплата поставщику' : 'Долг поставщику с прихода'}\r\n                  </td>\r\n                  <td>{op.employee}</td>\r\n                  <td className={op.record_type === 'withdraw_employee' \r\n                      ? 'color-red1-light font-16' :'color-green1-light font-16'}>\r\n                    {op.record_type === 'withdraw_employee' ? '-' + op.amount : '+' + op.amount}\r\n                  </td>\r\n                </tr>\r\n                )}\r\n            </tbody>\r\n          </table>\r\n        : <div>Нет операции</div>\r\n        }\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nfunction CreateRamshik (props) {\r\n  const { newCash, newName, createRamshik, setData } = props\r\n  const [open, setOpen] = useState(false);\r\n\r\n  const create = () => (\r\n    setOpen(false),\r\n    createRamshik()\r\n  )\r\n\r\n  return (\r\n    open \r\n      ? <div className='card card-style'>\r\n          <div className='content'>\r\n            <div className='  my-1'>\r\n              <TextField type='text' name='newName' value={newName} onChange={setData} label='Имя' \r\n                fullWidth className='mb-2'/>\r\n              <TextField type='number' name='newCash' value={newCash} onChange={setData} label='Баланс' fullWidth/>\r\n            </div>\r\n            <div className='d-flex justify-content-between mt-3'>\r\n              <button className='btn btn-s bg-highlight' onClick={create}>Создать</button>\r\n              <button className='btn btn-s bg-red1-light' onClick={() => setOpen(false)}>Отмена</button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      : <div className='d-flex justify-content-center my-3'>\r\n          <button className='btn btn-l bg-highlight' onClick={setOpen}>\r\n            Создать нового поставщика\r\n          </button>\r\n        </div>\r\n  )\r\n}\r\n\r\n\r\nexport default class RamshikPayments extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      employees: [],\r\n      activeEmployee: null,\r\n      amount: 0,\r\n\r\n      last_payouts: [],\r\n\r\n      message: null,\r\n      error: null,\r\n\r\n      newName: '',\r\n      newCash: 0\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    const token = localStorage.getItem('token');\r\n    axios(\r\n      {\r\n        method: 'get',\r\n        url: endpoints.EMPLOYEE_PAYOUT_INIT_DATA,\r\n        headers: { 'Authorization': `JWT ${token}` }\r\n      }\r\n    )\r\n    .then(res => {\r\n        const initData = res.data;\r\n        this.setState({ ...this.state, employees: initData.employees, last_payouts: initData.last_payouts });\r\n      })\r\n  }\r\n\r\n  payout = () => {\r\n    const { activeEmployee, amount } = this.state\r\n    const token = localStorage.getItem('token');\r\n    const formData = new FormData();\r\n    formData.append(\"employee\", activeEmployee.id);\r\n    formData.append(\"amount\", amount);\r\n        \r\n    axios({\r\n      method: 'post',\r\n      url: endpoints.EMPLOYEE_PAYOUT,\r\n      data: formData,\r\n      headers: { 'content-type': 'multipart/form-data', 'Authorization': `JWT ${token}` }\r\n    })\r\n    .then(response => {\r\n      this.setState({ ...this.state, message: response.data.message, employees: response.data.employees,\r\n        activeEmployee: null, last_payouts: response.data.last_payouts\r\n      });\r\n    })\r\n    .catch(err => {\r\n        const error = new Error(err);\r\n        error.data = parseErrorData(err);\r\n        this.setState({ message: 'Ошибка' });\r\n        throw error;\r\n    })\r\n  }\r\n\r\n  setData = (e) =>{\r\n    this.setState({\r\n      [e.target.name]: e.target.value \r\n    })\r\n  }\r\n\r\n  createRamshik = () => {\r\n    const token = localStorage.getItem('token');\r\n    axios({\r\n      method: 'post',\r\n      url: endpoints.EMPLOYEE_CREATE,\r\n      data: { nickname: this.state.newName, cash: this.state.newCash },\r\n      headers: { 'content-type': 'application/JSON', 'Authorization': `JWT ${token}` }\r\n    })\r\n    .then(response => {\r\n      this.setState({ employees: response.data.employees, activeEmployee: null });\r\n    })\r\n  }\r\n\r\n  deleteRamshik = () => {\r\n    const token = localStorage.getItem('token');\r\n    axios({\r\n      method: 'delete',\r\n      url: endpoints.manager_ramshiki_delete(this.state.activeEmployee.id),\r\n      headers: { 'content-type': 'application/JSON', 'Authorization': `JWT ${token}` }\r\n    })\r\n    .then(response => {\r\n      this.setState({ employees: response.data.employees, activeEmployee: null });\r\n    })\r\n  }\r\n\r\n  render() {\r\n    const { employees, activeEmployee, amount, message, last_payouts } = this.state\r\n    return (\r\n      <div className='mt-2'>\r\n        <div className='card card-style mb-2'>\r\n          <div className='content'>\r\n            <h4 className='mb-2'>Расчет поставщиков</h4>\r\n            <div className=''>\r\n              {employees.length > 0 &&\r\n                  <table className='table table-sm'>\r\n                    <thead>\r\n                      <th>поставщик</th>\r\n                      <th>баланс</th>\r\n                    </thead>\r\n                    <tbody>\r\n                      {employees.map(employee => \r\n                        <tr className={activeEmployee && activeEmployee.id === employee.id && 'bg-green1-light'}\r\n                          onClick={() => this.setState({...this.state, activeEmployee: employee, message: null})}>\r\n                          <td>{employee.nickname}</td>\r\n                          <td>{employee.cash} р /  {employee.cash_amount}</td>\r\n                        </tr>\r\n                        )}\r\n                    </tbody>\r\n                  </table>\r\n              }\r\n              {activeEmployee && \r\n                <div className='w-100'>\r\n                  <span className='font-16 mr-3'>{activeEmployee.nickname}</span>\r\n                  <span className='font-16 font-600'>{activeEmployee.cash} р</span>\r\n                  <div className='d-flex justify-content-start mt-2 mb-4'>\r\n                    <TextField type='number' className='mr-3' value={amount}\r\n                      onChange={(e) => this.setState({...this.state, amount: e.target.value})} />\r\n                    <button className='d-block btn btn-s bg-green2-light'\r\n                      onClick={this.payout}>\r\n                      Оплатить\r\n                    </button>\r\n                  </div>\r\n                  <button className='d-block btn btn-s bg-red1-light mt-2'\r\n                    onClick={this.deleteRamshik}>\r\n                    Удалить поставщика\r\n                  </button>\r\n                </div>\r\n              }\r\n              {message &&\r\n                <p className='color-dark text-center'>{message}</p>\r\n              }\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <CreateRamshik newName={this.state.newName} newCash={this.state.newCash} setData={this.setData}\r\n          createRamshik={this.createRamshik}\r\n          />\r\n        <LastOperations lastOperations={last_payouts} />\r\n      </div>\r\n    )\r\n  }\r\n}","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport {\r\n  BrowserRouter as Router,\r\n  Switch,\r\n  Route,\r\n} from \"react-router-dom\";\r\n\r\nimport { Provider } from 'react-redux';\r\nimport configureStore from './redux/store/';\r\nimport { SnackbarProvider } from 'notistack';\r\n\r\n// Containers\r\nimport Main from './containers/Main';\r\nimport Header from './containers/HeaderContainer';\r\nimport ManagerShiftList  from './containers/manager/Shifts';\r\n\r\n// import ManagerStock from './containers/manager/Stock';\r\nimport ManagerStock from './pages/stockPage/Stock';\r\n\r\nimport ShiftCreateComponent from './containers/manager/CreateShift';\r\nimport SaleCreateCommonContainer from './containers/manager/SaleCreateCommon';\r\nimport SaleList from './containers/manager/SaleList';\r\nimport DailyRepContainer from './containers/manager/DailyRep';\r\nimport ExpensesContainer from './containers/manager/Expenses';\r\nimport ManagerRamshikPayments  from './containers/manager/RamshikPayments';\r\n\r\nconst store = configureStore()\r\n \r\nReactDOM.render(\r\n  <Provider store={store}>\r\n    <SnackbarProvider maxSnack={3}>\r\n      <Router>\r\n        <div className='app' id=\"page\">\r\n          <Header />\r\n          <div className=\"page-content header-clear\">\r\n            <Switch>\r\n              <Route exact path=\"/\" component={Main} />\r\n\r\n              <Route exact path=\"/manager/shift_list/\" \r\n                component={ManagerShiftList} />\r\n\r\n              <Route exact path=\"/manager/stock/\" \r\n                component={ManagerStock} />\r\n\r\n              <Route exact path=\"/manager/sale_list/\" \r\n                component={SaleList} />\r\n\r\n              <Route exact path=\"/manager/shift/create_shift/\" \r\n                component={ShiftCreateComponent} />\r\n\r\n              <Route exact path=\"/manager/sales/create_sale/\" \r\n                component={SaleCreateCommonContainer} />       \r\n\r\n              <Route exact path=\"/manager/expenses/\" \r\n                component={ExpensesContainer} />\r\n\r\n              <Route exact path=\"/manager/daily_report/\" \r\n                component={DailyRepContainer} />\r\n\r\n              <Route exact path=\"/manager/ramshik_payments/\" \r\n                component={ManagerRamshikPayments} />\r\n\r\n            </Switch>\r\n          </div>\r\n        </div>\r\n      </Router>\r\n    </SnackbarProvider>\r\n  </Provider>, document.getElementById('root')\r\n);"],"sourceRoot":""}